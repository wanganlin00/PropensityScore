<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Propensity Score - 1&nbsp; PSM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./matching.html" rel="next">
<link href="./PropensityScore.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./PropensityScore.html">倾向性评分</a></li><li class="breadcrumb-item"><a href="./PSM.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PSM</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Propensity Score</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">推荐阅读</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./PropensityScore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向性评分</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PSM.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PSM</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./matching.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">匹配（Matching）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stratification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">分层（Stratification）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./weighting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">加权</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./SensitivityAnalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">敏感性分析</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#%E6%95%B0%E6%8D%AE" id="toc-数据" class="nav-link active" data-scroll-target="#%E6%95%B0%E6%8D%AE"><span class="header-section-number">1.1</span> 数据</a></li>
  <li>
<a href="#ps%E4%BC%B0%E8%AE%A1%E6%A8%A1%E5%9E%8B-distance" id="toc-ps估计模型-distance" class="nav-link" data-scroll-target="#ps%E4%BC%B0%E8%AE%A1%E6%A8%A1%E5%9E%8B-distance"><span class="header-section-number">1.2</span> PS估计模型 <code>distance</code></a>
  <ul>
<li><a href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92" id="toc-逻辑回归" class="nav-link" data-scroll-target="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="header-section-number">1.2.1</span> 逻辑回归</a></li>
  <li><a href="#%E5%88%86%E7%B1%BB%E5%92%8C%E5%9B%9E%E5%BD%92%E6%A0%91" id="toc-分类和回归树" class="nav-link" data-scroll-target="#%E5%88%86%E7%B1%BB%E5%92%8C%E5%9B%9E%E5%BD%92%E6%A0%91"><span class="header-section-number">1.2.2</span> 分类和回归树</a></li>
  <li><a href="#%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97" id="toc-随机森林" class="nav-link" data-scroll-target="#%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97"><span class="header-section-number">1.2.3</span> 随机森林</a></li>
  </ul>
</li>
  <li><a href="#%E8%B7%9D%E7%A6%BB%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95-method" id="toc-距离匹配算法-method" class="nav-link" data-scroll-target="#%E8%B7%9D%E7%A6%BB%E5%8C%B9%E9%85%8D%E7%AE%97%E6%B3%95-method"><span class="header-section-number">1.3</span> 距离匹配算法 <code>method</code></a></li>
  <li>
<a href="#%E5%B9%B3%E8%A1%A1%E8%AF%8A%E6%96%AD" id="toc-平衡诊断" class="nav-link" data-scroll-target="#%E5%B9%B3%E8%A1%A1%E8%AF%8A%E6%96%AD"><span class="header-section-number">1.4</span> 平衡诊断</a>
  <ul>
<li><a href="#smd-%E5%92%8C-vr" id="toc-smd-和-vr" class="nav-link" data-scroll-target="#smd-%E5%92%8C-vr"><span class="header-section-number">1.4.1</span> SMD 和 VR</a></li>
  <li><a href="#%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8C" id="toc-显著性检验" class="nav-link" data-scroll-target="#%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8C"><span class="header-section-number">1.4.2</span> <strong>显著性检验</strong></a></li>
  <li><a href="#%E5%88%86%E5%B8%83%E5%8F%AF%E8%A7%86%E5%8C%96" id="toc-分布可视化" class="nav-link" data-scroll-target="#%E5%88%86%E5%B8%83%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="header-section-number">1.4.3</span> <strong>分布可视化</strong></a></li>
  <li><a href="#%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6%E6%8C%87%E6%A0%87" id="toc-拟合优度指标" class="nav-link" data-scroll-target="#%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6%E6%8C%87%E6%A0%87"><span class="header-section-number">1.4.4</span> <strong>拟合优度指标</strong></a></li>
  <li><a href="#%E5%A6%82%E6%9E%9C%E5%8D%8F%E5%8F%98%E9%87%8F%E5%9C%A8%E5%8C%B9%E9%85%8D%E5%90%8E%E4%BB%8D%E7%84%B6%E4%B8%8D%E5%B9%B3%E8%A1%A1%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E" id="toc-如果协变量在匹配后仍然不平衡该怎么办" class="nav-link" data-scroll-target="#%E5%A6%82%E6%9E%9C%E5%8D%8F%E5%8F%98%E9%87%8F%E5%9C%A8%E5%8C%B9%E9%85%8D%E5%90%8E%E4%BB%8D%E7%84%B6%E4%B8%8D%E5%B9%B3%E8%A1%A1%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E"><span class="header-section-number">1.4.5</span> 如果协变量在匹配后仍然不平衡，该怎么办？</a></li>
  </ul>
</li>
  <li>
<a href="#%E9%9D%9E%E9%9A%8F%E6%9C%BA%E8%AF%95%E9%AA%8C%E4%B8%AD%E7%9A%84%E4%BA%8C%E5%88%86%E7%B1%BB%E6%B2%BB%E7%96%97%E6%95%88%E6%9E%9C" id="toc-非随机试验中的二分类治疗效果" class="nav-link" data-scroll-target="#%E9%9D%9E%E9%9A%8F%E6%9C%BA%E8%AF%95%E9%AA%8C%E4%B8%AD%E7%9A%84%E4%BA%8C%E5%88%86%E7%B1%BB%E6%B2%BB%E7%96%97%E6%95%88%E6%9E%9C"><span class="header-section-number">1.5</span> 非随机试验中的二分类治疗效果</a>
  <ul>
<li><a href="#att" id="toc-att" class="nav-link" data-scroll-target="#att"><span class="header-section-number">1.5.1</span> ATT</a></li>
  <li>
<a href="#%E6%95%8F%E6%84%9F%E6%80%A7%E5%88%86%E6%9E%90" id="toc-敏感性分析" class="nav-link" data-scroll-target="#%E6%95%8F%E6%84%9F%E6%80%A7%E5%88%86%E6%9E%90"><span class="header-section-number">1.5.2</span> 敏感性分析</a>
  <ul class="collapse">
<li><a href="#rosenbaum-%E7%9A%84%E5%8E%9F%E5%A7%8B%E6%95%8F%E6%84%9F%E6%80%A7%E5%88%86%E6%9E%90" id="toc-rosenbaum-的原始敏感性分析" class="nav-link" data-scroll-target="#rosenbaum-%E7%9A%84%E5%8E%9F%E5%A7%8B%E6%95%8F%E6%84%9F%E6%80%A7%E5%88%86%E6%9E%90"><span class="header-section-number">1.5.2.1</span> Rosenbaum 的原始敏感性分析</a></li>
  <li><a href="#e-%E5%80%BC" id="toc-e-值" class="nav-link" data-scroll-target="#e-%E5%80%BC"><span class="header-section-number">1.5.2.2</span> E 值</a></li>
  <li><a href="#%E5%80%BE%E5%90%91%E5%BE%97%E5%88%86%E6%A0%A1%E5%87%86-psc" id="toc-倾向得分校准-psc" class="nav-link" data-scroll-target="#%E5%80%BE%E5%90%91%E5%BE%97%E5%88%86%E6%A0%A1%E5%87%86-psc"><span class="header-section-number">1.5.2.3</span> 倾向得分校准 （PSC）</a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#%E5%A4%9A%E5%88%86%E7%B1%BB%E6%88%96%E8%BF%9E%E7%BB%AD%E6%B2%BB%E7%96%97" id="toc-多分类或连续治疗" class="nav-link" data-scroll-target="#%E5%A4%9A%E5%88%86%E7%B1%BB%E6%88%96%E8%BF%9E%E7%BB%AD%E6%B2%BB%E7%96%97"><span class="header-section-number">1.6</span> 多分类或连续治疗</a></li>
  <li><a href="#%E6%97%B6%E9%97%B4%E4%BE%9D%E8%B5%96%E6%80%A7%E5%8D%8F%E5%8F%98%E9%87%8F" id="toc-时间依赖性协变量" class="nav-link" data-scroll-target="#%E6%97%B6%E9%97%B4%E4%BE%9D%E8%B5%96%E6%80%A7%E5%8D%8F%E5%8F%98%E9%87%8F"><span class="header-section-number">1.7</span> 时间依赖性协变量</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./PropensityScore.html">倾向性评分</a></li><li class="breadcrumb-item"><a href="./PSM.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PSM</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">1</span>&nbsp; <span class="chapter-title">PSM</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="数据" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="数据">
<span class="header-section-number">1.1</span> 数据</h2>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">####################       数据模拟     ################################</span></span>
<span></span>
<span><span class="co"># 模拟了吸烟与心血管疾病 （CVD） 之间的关系，其中年龄和性别是潜在的混杂协变量</span></span>
<span></span>
<span><span class="co"># CVD 是结果变量（当患者没有 CVD 时，CVD = 0;否则，CVD =1）。</span></span>
<span><span class="co"># 吸烟是一个二进制变量，表示患者是否吸烟。性别（0 = 女性，1 = 男性）和年龄是两个混杂的协变量</span></span>
<span></span>
<span></span>
<span><span class="va">x.Gender</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">400</span>,<span class="fl">600</span><span class="op">)</span><span class="op">)</span><span class="co"># 400 females and 600 males</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">x.Age</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1000</span>,mean<span class="op">=</span><span class="fl">45</span>,sd<span class="op">=</span><span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 模拟数据的真实PS值</span></span>
<span><span class="va">z</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">x.Age</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">/</span><span class="fl">15</span><span class="op">-</span><span class="op">(</span><span class="va">x.Age</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">100</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">x.Gender</span></span>
<span><span class="va">tps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="co"># The true PS</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">Smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">&lt;</span> <span class="va">tps</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z.y</span><span class="op">&lt;-</span><span class="va">x.Gender</span> <span class="op">+</span><span class="fl">0.3</span><span class="op">*</span><span class="va">x.Age</span> <span class="op">+</span><span class="fl">5</span><span class="op">*</span><span class="va">Smoke</span><span class="op">-</span><span class="fl">20</span></span>
<span><span class="va">y</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z.y</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z.y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">CVD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">&lt;</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">124</span><span class="op">)</span></span>
<span><span class="va">x.Age.mask</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span><span class="co"># Missing completely at random</span></span>
<span><span class="va">x.Age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x.Age.mask</span><span class="op">==</span><span class="fl">1</span>,<span class="cn">NA</span>, <span class="va">x.Age</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x.Age</span>,<span class="va">x.Gender</span>, <span class="va">Smoke</span>, <span class="va">CVD</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   x.Age x.Gender Smoke CVD</span></span>
<span><span class="co">#&gt; 1    51        0     1   1</span></span>
<span><span class="co">#&gt; 2    50        0     0   0</span></span>
<span><span class="co">#&gt; 3    29        0     0   0</span></span>
<span><span class="co">#&gt; 4    28        0     0   0</span></span>
<span><span class="co">#&gt; 5     3        0     0   0</span></span>
<span><span class="co">#&gt; 6    56        0     1   1</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaz-yos/tableone">tableone</a></span><span class="op">)</span></span>
<span><span class="va">tbl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html">CreateTableOne</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.Age"</span>,<span class="st">"x.Gender"</span>,<span class="st">"CVD"</span><span class="op">)</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                       factorVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.Gender"</span>,<span class="st">"CVD"</span><span class="op">)</span>,</span>
<span>                       strata <span class="op">=</span> <span class="st">"Smoke"</span>,smd <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tbl1</span>, showAllLevels <span class="op">=</span> <span class="cn">T</span>, smd <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Stratified by Smoke</span></span>
<span><span class="co">#&gt;                     level 0             1             p      test SMD   </span></span>
<span><span class="co">#&gt;   n                         546           454                           </span></span>
<span><span class="co">#&gt;   x.Age (mean (SD))       43.30 (19.09) 46.73 (8.32)   0.001       0.233</span></span>
<span><span class="co">#&gt;   x.Gender (%)      0       297 (54.4)    103 (22.7)  &lt;0.001       0.689</span></span>
<span><span class="co">#&gt;                     1       249 (45.6)    351 (77.3)                    </span></span>
<span><span class="co">#&gt;   CVD (%)           0       470 (86.1)    204 (44.9)  &lt;0.001       0.960</span></span>
<span><span class="co">#&gt;                     1        76 (13.9)    250 (55.1)</span></span>
<span><span class="va">tbl1</span></span>
<span><span class="co">#&gt;                    Stratified by Smoke</span></span>
<span><span class="co">#&gt;                     level 0               1               p        test</span></span>
<span><span class="co">#&gt;   n                 ""    "  546"         "  454"         ""       ""  </span></span>
<span><span class="co">#&gt;   x.Age (mean (SD)) ""    "43.30 (19.09)" "46.73 (8.32)"  " 0.001" ""  </span></span>
<span><span class="co">#&gt;   x.Gender (%)      "0"   "  297 (54.4) " "  103 (22.7) " "&lt;0.001" ""  </span></span>
<span><span class="co">#&gt;                     "1"   "  249 (45.6) " "  351 (77.3) " ""       ""  </span></span>
<span><span class="co">#&gt;   CVD (%)           "0"   "  470 (86.1) " "  204 (44.9) " "&lt;0.001" ""  </span></span>
<span><span class="co">#&gt;                     "1"   "   76 (13.9) " "  250 (55.1) " ""       ""  </span></span>
<span><span class="co">#&gt;                    Stratified by Smoke</span></span>
<span><span class="co">#&gt;                     SMD     </span></span>
<span><span class="co">#&gt;   n                 ""      </span></span>
<span><span class="co">#&gt;   x.Age (mean (SD)) " 0.233"</span></span>
<span><span class="co">#&gt;   x.Gender (%)      " 0.689"</span></span>
<span><span class="co">#&gt;                     ""      </span></span>
<span><span class="co">#&gt;   CVD (%)           " 0.960"</span></span>
<span><span class="co">#&gt;                     ""</span></span>
<span><span class="co"># 吸烟组和非吸烟组之间的年龄和性别协变量存在显著差异</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">######################################## 缺失值处理和数据整洁          ################</span></span>
<span></span>
<span><span class="fu">map_df</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   x.Age x.Gender Smoke   CVD</span></span>
<span><span class="co">#&gt;   &lt;int&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1   185        0     0     0</span></span>
<span></span>
<span><span class="co"># Gmd 是指基尼均值差</span></span>
<span><span class="fu">Hmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Hmisc/man/describe.html">describe</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; data </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  4  Variables      1000  Observations</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; x.Age </span></span>
<span><span class="co">#&gt;        n  missing distinct     Info     Mean      Gmd      .05      .10 </span></span>
<span><span class="co">#&gt;      815      185       83        1    44.83    17.22       20       26 </span></span>
<span><span class="co">#&gt;      .25      .50      .75      .90      .95 </span></span>
<span><span class="co">#&gt;       35       44       55       64       70 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lowest :   1   2   3   5   6, highest:  84  85  86  93 101</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; x.Gender </span></span>
<span><span class="co">#&gt;        n  missing distinct     Info      Sum     Mean      Gmd </span></span>
<span><span class="co">#&gt;     1000        0        2     0.72      600      0.6   0.4805 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Smoke </span></span>
<span><span class="co">#&gt;        n  missing distinct     Info      Sum     Mean      Gmd </span></span>
<span><span class="co">#&gt;     1000        0        2    0.744      454    0.454   0.4963 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; CVD </span></span>
<span><span class="co">#&gt;        n  missing distinct     Info      Sum     Mean      Gmd </span></span>
<span><span class="co">#&gt;     1000        0        2    0.659      326    0.326   0.4399 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statistikat/VIM">VIM</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data_knnimp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/VIM/man/kNN.html">kNN</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, k <span class="op">=</span> <span class="fl">10</span>, weights <span class="op">=</span> <span class="st">"auto"</span>, imp_var <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu">map_df</span><span class="op">(</span><span class="va">data_knnimp</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;   x.Age x.Gender Smoke   CVD</span></span>
<span><span class="co">#&gt;   &lt;int&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1     0        0     0     0</span></span>
<span></span>
<span><span class="va">data</span><span class="op">&lt;-</span> <span class="va">data_knnimp</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="op">-</span><span class="va">x.Age</span>,<span class="va">as.factor</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="ps估计模型-distance" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="ps估计模型-distance">
<span class="header-section-number">1.2</span> PS估计模型 <code>distance</code>
</h2>
<section id="逻辑回归" class="level3" data-number="1.2.1"><h3 data-number="1.2.1" class="anchored" data-anchor-id="逻辑回归">
<span class="header-section-number">1.2.1</span> 逻辑回归</h3>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">############################      ########################</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://kosukeimai.github.io/MatchIt/">MatchIt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="st">"logit"</span><span class="op">)</span> ,data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = Smoke ~ x.Age + x.Gender, family = binomial("logit"), </span></span>
<span><span class="co">#&gt;     data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)        x.Age    x.Gender1  </span></span>
<span><span class="co">#&gt;    -1.98523      0.02005      1.44400  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 999 Total (i.e. Null);  997 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1378 </span></span>
<span><span class="co">#&gt; Residual Deviance: 1252  AIC: 1258</span></span>
<span></span>
<span></span>
<span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">m.out</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = Smoke ~ x.Age + x.Gender, family = structure(list(</span></span>
<span><span class="co">#&gt;     family = "quasibinomial", link = "logit", linkfun = function (mu) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_link, mu), linkinv = function (eta) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_linkinv, eta), variance = function (mu) </span></span>
<span><span class="co">#&gt;     mu * (1 - mu), dev.resids = function (y, mu, wt) </span></span>
<span><span class="co">#&gt;     .Call(C_binomial_dev_resids, y, mu, wt), aic = function (y, </span></span>
<span><span class="co">#&gt;         n, mu, wt, dev) </span></span>
<span><span class="co">#&gt;     NA, mu.eta = function (eta) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_mu_eta, eta), initialize = {</span></span>
<span><span class="co">#&gt;         if (NCOL(y) == 1) {</span></span>
<span><span class="co">#&gt;             if (is.factor(y)) </span></span>
<span><span class="co">#&gt;                 y &lt;- y != levels(y)[1L]</span></span>
<span><span class="co">#&gt;             n &lt;- rep.int(1, nobs)</span></span>
<span><span class="co">#&gt;             y[weights == 0] &lt;- 0</span></span>
<span><span class="co">#&gt;             if (any(y &lt; 0 | y &gt; 1)) </span></span>
<span><span class="co">#&gt;                 stop("y values must be 0 &lt;= y &lt;= 1")</span></span>
<span><span class="co">#&gt;             mustart &lt;- (weights * y + 0.5)/(weights + 1)</span></span>
<span><span class="co">#&gt;             m &lt;- weights * y</span></span>
<span><span class="co">#&gt;             if ("quasibinomial" == "binomial" &amp;&amp; any(abs(m - </span></span>
<span><span class="co">#&gt;                 round(m)) &gt; 0.001)) </span></span>
<span><span class="co">#&gt;                 warning(gettextf("non-integer #successes in a %s glm!", </span></span>
<span><span class="co">#&gt;                   "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         else if (NCOL(y) == 2) {</span></span>
<span><span class="co">#&gt;             if ("quasibinomial" == "binomial" &amp;&amp; any(abs(y - </span></span>
<span><span class="co">#&gt;                 round(y)) &gt; 0.001)) </span></span>
<span><span class="co">#&gt;                 warning(gettextf("non-integer counts in a %s glm!", </span></span>
<span><span class="co">#&gt;                   "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;             n &lt;- (y1 &lt;- y[, 1L]) + y[, 2L]</span></span>
<span><span class="co">#&gt;             y &lt;- y1/n</span></span>
<span><span class="co">#&gt;             if (any(n0 &lt;- n == 0)) </span></span>
<span><span class="co">#&gt;                 y[n0] &lt;- 0</span></span>
<span><span class="co">#&gt;             weights &lt;- weights * n</span></span>
<span><span class="co">#&gt;             mustart &lt;- (n * y + 0.5)/(n + 1)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         else stop(gettextf("for the '%s' family, y must be a vector of 0 and 1's\nor a 2 column matrix where col 1 is no. successes and col 2 is no. failures", </span></span>
<span><span class="co">#&gt;             "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;     }, validmu = function (mu) </span></span>
<span><span class="co">#&gt;     all(is.finite(mu)) &amp;&amp; all(0 &lt; mu &amp; mu &lt; 1), valideta = function (eta) </span></span>
<span><span class="co">#&gt;     TRUE, dispersion = NA_real_), class = "family"), data = structure(list(</span></span>
<span><span class="co">#&gt;     x.Age = c(51, 50, 29, 28, 3, 56, 59, 42, 78, 47, 32, 37, </span></span>
<span><span class="co">#&gt;     63, 37, 43, 72, 71, 1, 37, 46, 78, 61, 50, 44, 58, 48, 37, </span></span>
<span><span class="co">#&gt;     59, 45, 47, 37, 34, 61, 78, 51, 45, 41, 51, 37, 52, 59, 37, </span></span>
<span><span class="co">#&gt;     40, 34, 27, 49, 45, 45, 55, 52, 42, 51, 35, 52, 47, 47, 42, </span></span>
<span><span class="co">#&gt;     25, 36, 54, 74, 49, 21, 93, 59, 51, 59, 42, 46, 48, 57, 78, </span></span>
<span><span class="co">#&gt;     37, 51, 31, 34, 18, 37, 46, 49, 54, 45, 78, 48, 30, 78, 17, </span></span>
<span><span class="co">#&gt;     61, 73, 53, 22, 16, 52, 64, 42, 33, 50, 55, 37, 35, 19, 30, </span></span>
<span><span class="co">#&gt;     36, 51, 56, 37, 40, 37, 49, 49, 40, 67, 60, 37, 49, 33, 27, </span></span>
<span><span class="co">#&gt;     26, 43, 78, 40, 51, 78, 37, 26, 48, 56, 78, 78, 31, 47, 36, </span></span>
<span><span class="co">#&gt;     44, 43, 29, 44, 71, 37, 85, 26, 45, 44, 78, 15, 52, 41, 28, </span></span>
<span><span class="co">#&gt;     48, 46, 37, 40, 37, 45, 23, 51, 45, 28, 46, 35, 55, 54, 37, </span></span>
<span><span class="co">#&gt;     37, 45, 16, 64, 50, 32, 17, 58, 64, 49, 37, 37, 37, 37, 37, </span></span>
<span><span class="co">#&gt;     27, 61, 45, 41, 58, 29, 19, 81, 42, 59, 34, 26, 58, 63, 27, </span></span>
<span><span class="co">#&gt;     56, 58, 37, 54, 29, 37, 51, 55, 34, 37, 39, 37, 37, 26, 62, </span></span>
<span><span class="co">#&gt;     61, 44, 37, 53, 41, 78, 34, 52, 37, 30, 37, 28, 37, 53, 24, </span></span>
<span><span class="co">#&gt;     43, 37, 33, 51, 62, 52, 37, 45, 53, 52, 20, 70, 6, 57, 52, </span></span>
<span><span class="co">#&gt;     55, 51, 70, 46, 45, 78, 69, 47, 41, 15, 67, 37, 33, 45, 36, </span></span>
<span><span class="co">#&gt;     68, 28, 26, 37, 64, 47, 51, 57, 37, 20, 42, 53, 43, 37, 22, </span></span>
<span><span class="co">#&gt;     44, 60, 40, 37, 27, 36, 37, 9, 79, 37, 48, 32, 25, 47, 3, </span></span>
<span><span class="co">#&gt;     56, 33, 61, 39, 51, 60, 58, 13, 2, 36, 64, 42, 50, 35, 37, </span></span>
<span><span class="co">#&gt;     78, 37, 36, 59, 42, 63, 68, 67, 80, 78, 58, 47, 37, 46, 45, </span></span>
<span><span class="co">#&gt;     48, 51, 44, 38, 42, 27, 37, 53, 47, 37, 41, 57, 55, 46, 15, </span></span>
<span><span class="co">#&gt;     51, 59, 71, 40, 57, 38, 23, 37, 73, 46, 37, 39, 37, 25, 34, </span></span>
<span><span class="co">#&gt;     30, 47, 56, 28, 48, 43, 47, 35, 32, 43, 53, 39, 40, 43, 35, </span></span>
<span><span class="co">#&gt;     37, 70, 35, 51, 7, 27, 43, 55, 44, 84, 43, 51, 37, 60, 39, </span></span>
<span><span class="co">#&gt;     48, 51, 45, 52, 78, 37, 30, 29, 73, 43, 35, 37, 28, 54, 21, </span></span>
<span><span class="co">#&gt;     27, 63, 36, 55, 52, 45, 41, 45, 59, 72, 45, 45, 37, 33.5, </span></span>
<span><span class="co">#&gt;     50, 61, 41, 41, 41, 48, 11, 34, 42, 41, 41, 40, 50, 42, 43, </span></span>
<span><span class="co">#&gt;     61, 35, 25, 41, 59, 17, 46, 50, 51, 41, 27, 41, 41, 37, 53, </span></span>
<span><span class="co">#&gt;     36, 57, 30, 60, 50, 42, 47, 32, 40, 35, 46, 33.5, 68, 54, </span></span>
<span><span class="co">#&gt;     41, 36, 29, 67, 37, 36, 59, 40, 50, 50, 41, 46, 33, 50, 45, </span></span>
<span><span class="co">#&gt;     65, 50, 50, 64, 41, 63, 53, 21, 41, 40, 43, 33.5, 41, 37, </span></span>
<span><span class="co">#&gt;     50, 33, 43, 16, 68, 41, 31, 55, 42, 42, 42, 55, 66, 44, 33.5, </span></span>
<span><span class="co">#&gt;     43, 31, 68, 38, 51, 22, 45, 41, 41, 45, 79, 63, 45, 63, 47, </span></span>
<span><span class="co">#&gt;     68, 41, 39, 5, 21, 60, 16, 67, 46, 54, 35, 41, 43, 46, 45, </span></span>
<span><span class="co">#&gt;     44, 47, 53, 38, 43, 32, 25, 23, 51, 57, 50, 69, 63, 56, 53, </span></span>
<span><span class="co">#&gt;     40, 19, 44, 39, 41, 41, 36, 33, 50, 43, 78, 33.5, 39, 43, </span></span>
<span><span class="co">#&gt;     59, 41, 55, 41, 41, 26, 54, 38, 70, 60, 42, 48, 24, 33.5, </span></span>
<span><span class="co">#&gt;     36, 47, 50, 68, 41, 54, 82, 33, 41, 54, 51, 59, 25, 33.5, </span></span>
<span><span class="co">#&gt;     82, 52, 26, 22, 35, 74, 41, 41, 53, 29, 51, 53, 33.5, 40, </span></span>
<span><span class="co">#&gt;     14, 40, 63, 50, 48, 45, 38, 22, 59, 65, 49, 78, 50, 25, 50, </span></span>
<span><span class="co">#&gt;     60, 37, 50, 42, 45, 52, 50, 29, 33.5, 32, 58, 52, 68, 43, </span></span>
<span><span class="co">#&gt;     52, 69, 32, 47, 50, 28, 50, 46, 18, 50, 50, 41, 33.5, 20, </span></span>
<span><span class="co">#&gt;     61, 41, 40, 13, 28, 49, 27, 53, 62, 33.5, 37, 51, 40, 64, </span></span>
<span><span class="co">#&gt;     82, 57, 45, 22, 33.5, 33.5, 72, 42, 55, 30, 39, 21, 40, 34, </span></span>
<span><span class="co">#&gt;     33.5, 50, 11, 50, 21, 52, 34, 49, 48, 44, 25, 52, 26, 43, </span></span>
<span><span class="co">#&gt;     73, 61, 34, 35, 67, 18, 44, 42, 43, 25, 41, 47, 60, 50, 42, </span></span>
<span><span class="co">#&gt;     32, 27, 26, 56, 54, 24, 50, 44, 20, 41, 47, 47, 39, 38, 56, </span></span>
<span><span class="co">#&gt;     40, 36, 60, 59, 28, 79, 35, 29, 47, 101, 69, 50, 63, 54, </span></span>
<span><span class="co">#&gt;     56, 78, 39, 70, 37, 49, 50, 31, 37, 41, 55, 69, 40, 44, 37, </span></span>
<span><span class="co">#&gt;     33, 31, 67, 24, 41, 41, 68, 37, 50, 51, 67, 42, 41, 50, 44, </span></span>
<span><span class="co">#&gt;     31, 81, 52, 33.5, 29, 32, 51, 33, 33.5, 39, 71, 57, 57, 63, </span></span>
<span><span class="co">#&gt;     62, 65, 34, 55, 34, 2, 18, 57, 43, 63, 57, 59, 35, 41, 50, </span></span>
<span><span class="co">#&gt;     28, 46, 37, 33.5, 40, 52, 11, 33, 50, 50, 56, 48, 39, 50, </span></span>
<span><span class="co">#&gt;     33, 50, 73, 39, 26, 48, 54, 69, 51, 50, 45, 57, 56, 48, 27, </span></span>
<span><span class="co">#&gt;     33.5, 51, 23, 33.5, 66, 39, 40, 23, 45, 26, 84, 54, 49, 64, </span></span>
<span><span class="co">#&gt;     47, 47, 13, 66, 20, 40, 41, 39, 50, 41, 69, 48, 59, 35, 51, </span></span>
<span><span class="co">#&gt;     33.5, 35, 47, 54, 30, 56, 34, 41, 50, 76, 33.5, 47, 41, 44, </span></span>
<span><span class="co">#&gt;     58, 59, 44, 33.5, 31, 40, 43, 56, 50, 33.5, 54, 58, 52, 50, </span></span>
<span><span class="co">#&gt;     34, 41, 51, 38, 69, 53, 41, 31, 40, 34, 33.5, 49, 34, 41, </span></span>
<span><span class="co">#&gt;     22, 43, 54, 51, 42, 57, 48, 40, 65, 33, 27, 50, 69, 77, 31, </span></span>
<span><span class="co">#&gt;     45, 60, 20, 59, 50, 50, 32, 33.5, 55, 55, 56, 26, 67, 46, </span></span>
<span><span class="co">#&gt;     33.5, 40, 33, 30, 41, 57, 73, 20, 40, 26, 33.5, 49, 33.5, </span></span>
<span><span class="co">#&gt;     34, 65, 50, 41, 37, 66, 41, 50, 50, 30, 33, 41, 49, 48, 37, </span></span>
<span><span class="co">#&gt;     64, 32, 42, 48, 22, 33.5, 35, 34, 24, 41, 51, 86, 33.5, 41, </span></span>
<span><span class="co">#&gt;     35, 55, 50, 57, 8, 41, 41, 61, 23, 43, 54, 27, 50, 58, 31, </span></span>
<span><span class="co">#&gt;     46, 43, 52, 41, 51, 43, 41, 50, 58, 39, 41, 33.5, 35, 23, </span></span>
<span><span class="co">#&gt;     42, 50, 19, 33, 32, 64, 25, 36, 63, 20, 24, 34, 82, 36, 41, </span></span>
<span><span class="co">#&gt;     33.5, 51, 43, 70, 39, 57, 31), x.Gender = structure(c(1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), levels = c("0", "1"), class = "factor"), </span></span>
<span><span class="co">#&gt;     Smoke = structure(c(2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L</span></span>
<span><span class="co">#&gt;     ), levels = c("0", "1"), class = "factor"), CVD = structure(c(2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L), levels = c("0", "1"), class = "factor")), row.names = c(NA, </span></span>
<span><span class="co">#&gt; -1000L), class = "data.frame"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)        x.Age    x.Gender1  </span></span>
<span><span class="co">#&gt;    -1.98523      0.02005      1.44400  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 999 Total (i.e. Null);  997 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1378 </span></span>
<span><span class="co">#&gt; Residual Deviance: 1252  AIC: NA</span></span>
<span></span>
<span><span class="co"># 估计的PS值</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="va">m.out</span><span class="op">$</span><span class="va">distance</span></span>
<span></span>
<span><span class="co"># 模拟数据的真实PS值</span></span>
<span><span class="va">z</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">x.Age</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">/</span><span class="fl">15</span><span class="op">-</span><span class="op">(</span><span class="va">x.Age</span><span class="op">-</span><span class="fl">45</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">100</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">x.Gender</span></span>
<span></span>
<span><span class="va">tps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="co"># The true PS</span></span>
<span><span class="va">tps_comp</span> <span class="op">&lt;-</span> <span class="va">tps</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">smoke_comp</span> <span class="op">&lt;-</span> <span class="va">Smoke</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    True <span class="op">=</span> <span class="va">tps_comp</span>,</span>
<span>    Estimate <span class="op">=</span> <span class="va">eps</span>,  <span class="co"># 估计如此糟糕（就像 sin 函数一样），是因为我们通过二次方程生成 PS</span></span>
<span>    smoke<span class="op">=</span> <span class="va">smoke_comp</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; # A tibble: 1,000 × 3</span></span>
<span><span class="co">#&gt;        True Estimate smoke</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;</span></span>
<span><span class="co">#&gt;  1  5.10e-1    0.276 1    </span></span>
<span><span class="co">#&gt;  2  5.21e-1    0.272 0    </span></span>
<span><span class="co">#&gt;  3  2.59e-2    0.197 0    </span></span>
<span><span class="co">#&gt;  4  1.76e-2    0.194 0    </span></span>
<span><span class="co">#&gt;  5  1.33e-9    0.127 0    </span></span>
<span><span class="co">#&gt;  6  3.83e-1    0.297 1    </span></span>
<span><span class="co">#&gt;  7  2.64e-1    0.310 0    </span></span>
<span><span class="co">#&gt;  8  4.28e-1    0.242 0    </span></span>
<span><span class="co">#&gt;  9 NA          0.396 0    </span></span>
<span><span class="co">#&gt; 10  5.23e-1    0.261 1    </span></span>
<span><span class="co">#&gt; # ℹ 990 more rows</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">True</span>, <span class="va">Estimate</span>, colour <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>,slope <span class="op">=</span> <span class="fl">1</span>,color <span class="op">=</span> <span class="st">"#990000"</span>,</span>
<span>                linetype<span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="va">m.out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x.Age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eps2</span> <span class="op">&lt;-</span> <span class="va">m.out2</span><span class="op">$</span><span class="va">distance</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    True <span class="op">=</span> <span class="va">tps_comp</span>,</span>
<span>    Estimate <span class="op">=</span> <span class="va">eps2</span>,  <span class="co"># 估计如此糟糕（就像 sin 函数一样），是因为我们通过二次方程生成 PS</span></span>
<span>    smoke<span class="op">=</span> <span class="va">smoke_comp</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">True</span>, <span class="va">Estimate</span>, colour <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>,slope <span class="op">=</span> <span class="fl">1</span>,color <span class="op">=</span> <span class="st">"#990000"</span>,</span>
<span>                linetype<span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">m.out2</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  glm(formula = Smoke ~ x.Age + I(x.Age^2) + x.Gender, family = structure(list(</span></span>
<span><span class="co">#&gt;     family = "quasibinomial", link = "logit", linkfun = function (mu) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_link, mu), linkinv = function (eta) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_linkinv, eta), variance = function (mu) </span></span>
<span><span class="co">#&gt;     mu * (1 - mu), dev.resids = function (y, mu, wt) </span></span>
<span><span class="co">#&gt;     .Call(C_binomial_dev_resids, y, mu, wt), aic = function (y, </span></span>
<span><span class="co">#&gt;         n, mu, wt, dev) </span></span>
<span><span class="co">#&gt;     NA, mu.eta = function (eta) </span></span>
<span><span class="co">#&gt;     .Call(C_logit_mu_eta, eta), initialize = {</span></span>
<span><span class="co">#&gt;         if (NCOL(y) == 1) {</span></span>
<span><span class="co">#&gt;             if (is.factor(y)) </span></span>
<span><span class="co">#&gt;                 y &lt;- y != levels(y)[1L]</span></span>
<span><span class="co">#&gt;             n &lt;- rep.int(1, nobs)</span></span>
<span><span class="co">#&gt;             y[weights == 0] &lt;- 0</span></span>
<span><span class="co">#&gt;             if (any(y &lt; 0 | y &gt; 1)) </span></span>
<span><span class="co">#&gt;                 stop("y values must be 0 &lt;= y &lt;= 1")</span></span>
<span><span class="co">#&gt;             mustart &lt;- (weights * y + 0.5)/(weights + 1)</span></span>
<span><span class="co">#&gt;             m &lt;- weights * y</span></span>
<span><span class="co">#&gt;             if ("quasibinomial" == "binomial" &amp;&amp; any(abs(m - </span></span>
<span><span class="co">#&gt;                 round(m)) &gt; 0.001)) </span></span>
<span><span class="co">#&gt;                 warning(gettextf("non-integer #successes in a %s glm!", </span></span>
<span><span class="co">#&gt;                   "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         else if (NCOL(y) == 2) {</span></span>
<span><span class="co">#&gt;             if ("quasibinomial" == "binomial" &amp;&amp; any(abs(y - </span></span>
<span><span class="co">#&gt;                 round(y)) &gt; 0.001)) </span></span>
<span><span class="co">#&gt;                 warning(gettextf("non-integer counts in a %s glm!", </span></span>
<span><span class="co">#&gt;                   "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;             n &lt;- (y1 &lt;- y[, 1L]) + y[, 2L]</span></span>
<span><span class="co">#&gt;             y &lt;- y1/n</span></span>
<span><span class="co">#&gt;             if (any(n0 &lt;- n == 0)) </span></span>
<span><span class="co">#&gt;                 y[n0] &lt;- 0</span></span>
<span><span class="co">#&gt;             weights &lt;- weights * n</span></span>
<span><span class="co">#&gt;             mustart &lt;- (n * y + 0.5)/(n + 1)</span></span>
<span><span class="co">#&gt;         }</span></span>
<span><span class="co">#&gt;         else stop(gettextf("for the '%s' family, y must be a vector of 0 and 1's\nor a 2 column matrix where col 1 is no. successes and col 2 is no. failures", </span></span>
<span><span class="co">#&gt;             "quasibinomial"), domain = NA)</span></span>
<span><span class="co">#&gt;     }, validmu = function (mu) </span></span>
<span><span class="co">#&gt;     all(is.finite(mu)) &amp;&amp; all(0 &lt; mu &amp; mu &lt; 1), valideta = function (eta) </span></span>
<span><span class="co">#&gt;     TRUE, dispersion = NA_real_), class = "family"), data = structure(list(</span></span>
<span><span class="co">#&gt;     x.Age = c(51, 50, 29, 28, 3, 56, 59, 42, 78, 47, 32, 37, </span></span>
<span><span class="co">#&gt;     63, 37, 43, 72, 71, 1, 37, 46, 78, 61, 50, 44, 58, 48, 37, </span></span>
<span><span class="co">#&gt;     59, 45, 47, 37, 34, 61, 78, 51, 45, 41, 51, 37, 52, 59, 37, </span></span>
<span><span class="co">#&gt;     40, 34, 27, 49, 45, 45, 55, 52, 42, 51, 35, 52, 47, 47, 42, </span></span>
<span><span class="co">#&gt;     25, 36, 54, 74, 49, 21, 93, 59, 51, 59, 42, 46, 48, 57, 78, </span></span>
<span><span class="co">#&gt;     37, 51, 31, 34, 18, 37, 46, 49, 54, 45, 78, 48, 30, 78, 17, </span></span>
<span><span class="co">#&gt;     61, 73, 53, 22, 16, 52, 64, 42, 33, 50, 55, 37, 35, 19, 30, </span></span>
<span><span class="co">#&gt;     36, 51, 56, 37, 40, 37, 49, 49, 40, 67, 60, 37, 49, 33, 27, </span></span>
<span><span class="co">#&gt;     26, 43, 78, 40, 51, 78, 37, 26, 48, 56, 78, 78, 31, 47, 36, </span></span>
<span><span class="co">#&gt;     44, 43, 29, 44, 71, 37, 85, 26, 45, 44, 78, 15, 52, 41, 28, </span></span>
<span><span class="co">#&gt;     48, 46, 37, 40, 37, 45, 23, 51, 45, 28, 46, 35, 55, 54, 37, </span></span>
<span><span class="co">#&gt;     37, 45, 16, 64, 50, 32, 17, 58, 64, 49, 37, 37, 37, 37, 37, </span></span>
<span><span class="co">#&gt;     27, 61, 45, 41, 58, 29, 19, 81, 42, 59, 34, 26, 58, 63, 27, </span></span>
<span><span class="co">#&gt;     56, 58, 37, 54, 29, 37, 51, 55, 34, 37, 39, 37, 37, 26, 62, </span></span>
<span><span class="co">#&gt;     61, 44, 37, 53, 41, 78, 34, 52, 37, 30, 37, 28, 37, 53, 24, </span></span>
<span><span class="co">#&gt;     43, 37, 33, 51, 62, 52, 37, 45, 53, 52, 20, 70, 6, 57, 52, </span></span>
<span><span class="co">#&gt;     55, 51, 70, 46, 45, 78, 69, 47, 41, 15, 67, 37, 33, 45, 36, </span></span>
<span><span class="co">#&gt;     68, 28, 26, 37, 64, 47, 51, 57, 37, 20, 42, 53, 43, 37, 22, </span></span>
<span><span class="co">#&gt;     44, 60, 40, 37, 27, 36, 37, 9, 79, 37, 48, 32, 25, 47, 3, </span></span>
<span><span class="co">#&gt;     56, 33, 61, 39, 51, 60, 58, 13, 2, 36, 64, 42, 50, 35, 37, </span></span>
<span><span class="co">#&gt;     78, 37, 36, 59, 42, 63, 68, 67, 80, 78, 58, 47, 37, 46, 45, </span></span>
<span><span class="co">#&gt;     48, 51, 44, 38, 42, 27, 37, 53, 47, 37, 41, 57, 55, 46, 15, </span></span>
<span><span class="co">#&gt;     51, 59, 71, 40, 57, 38, 23, 37, 73, 46, 37, 39, 37, 25, 34, </span></span>
<span><span class="co">#&gt;     30, 47, 56, 28, 48, 43, 47, 35, 32, 43, 53, 39, 40, 43, 35, </span></span>
<span><span class="co">#&gt;     37, 70, 35, 51, 7, 27, 43, 55, 44, 84, 43, 51, 37, 60, 39, </span></span>
<span><span class="co">#&gt;     48, 51, 45, 52, 78, 37, 30, 29, 73, 43, 35, 37, 28, 54, 21, </span></span>
<span><span class="co">#&gt;     27, 63, 36, 55, 52, 45, 41, 45, 59, 72, 45, 45, 37, 33.5, </span></span>
<span><span class="co">#&gt;     50, 61, 41, 41, 41, 48, 11, 34, 42, 41, 41, 40, 50, 42, 43, </span></span>
<span><span class="co">#&gt;     61, 35, 25, 41, 59, 17, 46, 50, 51, 41, 27, 41, 41, 37, 53, </span></span>
<span><span class="co">#&gt;     36, 57, 30, 60, 50, 42, 47, 32, 40, 35, 46, 33.5, 68, 54, </span></span>
<span><span class="co">#&gt;     41, 36, 29, 67, 37, 36, 59, 40, 50, 50, 41, 46, 33, 50, 45, </span></span>
<span><span class="co">#&gt;     65, 50, 50, 64, 41, 63, 53, 21, 41, 40, 43, 33.5, 41, 37, </span></span>
<span><span class="co">#&gt;     50, 33, 43, 16, 68, 41, 31, 55, 42, 42, 42, 55, 66, 44, 33.5, </span></span>
<span><span class="co">#&gt;     43, 31, 68, 38, 51, 22, 45, 41, 41, 45, 79, 63, 45, 63, 47, </span></span>
<span><span class="co">#&gt;     68, 41, 39, 5, 21, 60, 16, 67, 46, 54, 35, 41, 43, 46, 45, </span></span>
<span><span class="co">#&gt;     44, 47, 53, 38, 43, 32, 25, 23, 51, 57, 50, 69, 63, 56, 53, </span></span>
<span><span class="co">#&gt;     40, 19, 44, 39, 41, 41, 36, 33, 50, 43, 78, 33.5, 39, 43, </span></span>
<span><span class="co">#&gt;     59, 41, 55, 41, 41, 26, 54, 38, 70, 60, 42, 48, 24, 33.5, </span></span>
<span><span class="co">#&gt;     36, 47, 50, 68, 41, 54, 82, 33, 41, 54, 51, 59, 25, 33.5, </span></span>
<span><span class="co">#&gt;     82, 52, 26, 22, 35, 74, 41, 41, 53, 29, 51, 53, 33.5, 40, </span></span>
<span><span class="co">#&gt;     14, 40, 63, 50, 48, 45, 38, 22, 59, 65, 49, 78, 50, 25, 50, </span></span>
<span><span class="co">#&gt;     60, 37, 50, 42, 45, 52, 50, 29, 33.5, 32, 58, 52, 68, 43, </span></span>
<span><span class="co">#&gt;     52, 69, 32, 47, 50, 28, 50, 46, 18, 50, 50, 41, 33.5, 20, </span></span>
<span><span class="co">#&gt;     61, 41, 40, 13, 28, 49, 27, 53, 62, 33.5, 37, 51, 40, 64, </span></span>
<span><span class="co">#&gt;     82, 57, 45, 22, 33.5, 33.5, 72, 42, 55, 30, 39, 21, 40, 34, </span></span>
<span><span class="co">#&gt;     33.5, 50, 11, 50, 21, 52, 34, 49, 48, 44, 25, 52, 26, 43, </span></span>
<span><span class="co">#&gt;     73, 61, 34, 35, 67, 18, 44, 42, 43, 25, 41, 47, 60, 50, 42, </span></span>
<span><span class="co">#&gt;     32, 27, 26, 56, 54, 24, 50, 44, 20, 41, 47, 47, 39, 38, 56, </span></span>
<span><span class="co">#&gt;     40, 36, 60, 59, 28, 79, 35, 29, 47, 101, 69, 50, 63, 54, </span></span>
<span><span class="co">#&gt;     56, 78, 39, 70, 37, 49, 50, 31, 37, 41, 55, 69, 40, 44, 37, </span></span>
<span><span class="co">#&gt;     33, 31, 67, 24, 41, 41, 68, 37, 50, 51, 67, 42, 41, 50, 44, </span></span>
<span><span class="co">#&gt;     31, 81, 52, 33.5, 29, 32, 51, 33, 33.5, 39, 71, 57, 57, 63, </span></span>
<span><span class="co">#&gt;     62, 65, 34, 55, 34, 2, 18, 57, 43, 63, 57, 59, 35, 41, 50, </span></span>
<span><span class="co">#&gt;     28, 46, 37, 33.5, 40, 52, 11, 33, 50, 50, 56, 48, 39, 50, </span></span>
<span><span class="co">#&gt;     33, 50, 73, 39, 26, 48, 54, 69, 51, 50, 45, 57, 56, 48, 27, </span></span>
<span><span class="co">#&gt;     33.5, 51, 23, 33.5, 66, 39, 40, 23, 45, 26, 84, 54, 49, 64, </span></span>
<span><span class="co">#&gt;     47, 47, 13, 66, 20, 40, 41, 39, 50, 41, 69, 48, 59, 35, 51, </span></span>
<span><span class="co">#&gt;     33.5, 35, 47, 54, 30, 56, 34, 41, 50, 76, 33.5, 47, 41, 44, </span></span>
<span><span class="co">#&gt;     58, 59, 44, 33.5, 31, 40, 43, 56, 50, 33.5, 54, 58, 52, 50, </span></span>
<span><span class="co">#&gt;     34, 41, 51, 38, 69, 53, 41, 31, 40, 34, 33.5, 49, 34, 41, </span></span>
<span><span class="co">#&gt;     22, 43, 54, 51, 42, 57, 48, 40, 65, 33, 27, 50, 69, 77, 31, </span></span>
<span><span class="co">#&gt;     45, 60, 20, 59, 50, 50, 32, 33.5, 55, 55, 56, 26, 67, 46, </span></span>
<span><span class="co">#&gt;     33.5, 40, 33, 30, 41, 57, 73, 20, 40, 26, 33.5, 49, 33.5, </span></span>
<span><span class="co">#&gt;     34, 65, 50, 41, 37, 66, 41, 50, 50, 30, 33, 41, 49, 48, 37, </span></span>
<span><span class="co">#&gt;     64, 32, 42, 48, 22, 33.5, 35, 34, 24, 41, 51, 86, 33.5, 41, </span></span>
<span><span class="co">#&gt;     35, 55, 50, 57, 8, 41, 41, 61, 23, 43, 54, 27, 50, 58, 31, </span></span>
<span><span class="co">#&gt;     46, 43, 52, 41, 51, 43, 41, 50, 58, 39, 41, 33.5, 35, 23, </span></span>
<span><span class="co">#&gt;     42, 50, 19, 33, 32, 64, 25, 36, 63, 20, 24, 34, 82, 36, 41, </span></span>
<span><span class="co">#&gt;     33.5, 51, 43, 70, 39, 57, 31), x.Gender = structure(c(1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L), levels = c("0", "1"), class = "factor"), </span></span>
<span><span class="co">#&gt;     Smoke = structure(c(2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 2L</span></span>
<span><span class="co">#&gt;     ), levels = c("0", "1"), class = "factor"), CVD = structure(c(2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 2L, 2L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 2L, 2L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 2L, 2L, 1L, 2L, 2L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 2L, 2L, 1L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 1L, 2L, 2L, 1L, 1L, 2L, 1L, 2L, 2L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     2L, 1L, 1L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, </span></span>
<span><span class="co">#&gt;     2L, 2L, 1L, 1L, 1L, 2L, 1L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, </span></span>
<span><span class="co">#&gt;     1L, 1L, 1L, 2L, 1L, 2L, 1L, 2L, 1L), levels = c("0", "1"), class = "factor")), row.names = c(NA, </span></span>
<span><span class="co">#&gt; -1000L), class = "data.frame"))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)        x.Age   I(x.Age^2)    x.Gender1  </span></span>
<span><span class="co">#&gt;   -28.99771      1.19555     -0.01223      2.12637  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 999 Total (i.e. Null);  996 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1378 </span></span>
<span><span class="co">#&gt; Residual Deviance: 819.7     AIC: NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="分类和回归树" class="level3" data-number="1.2.2"><h3 data-number="1.2.2" class="anchored" data-anchor-id="分类和回归树">
<span class="header-section-number">1.2.2</span> 分类和回归树</h3>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">########################## ##########</span></span>
<span><span class="va">m.out_rpart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                distance <span class="op">=</span> <span class="st">"rpart"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span>True <span class="op">=</span> <span class="va">tps_comp</span>,</span>
<span>       Estimate <span class="op">=</span> <span class="va">m.out_rpart</span><span class="op">$</span><span class="va">distance</span>,</span>
<span>       smoke <span class="op">=</span> <span class="va">smoke_comp</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">True</span>, <span class="va">Estimate</span>, colour <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>        intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"#990000"</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span><span class="va">m.out_rpart2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x.Age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                       distance <span class="op">=</span> <span class="st">"rpart"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span>True <span class="op">=</span> <span class="va">tps_comp</span>,</span>
<span>       Estimate <span class="op">=</span> <span class="va">m.out_rpart2</span><span class="op">$</span><span class="va">distance</span>,</span>
<span>       smoke <span class="op">=</span> <span class="va">smoke_comp</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">True</span>, <span class="va">Estimate</span>, colour <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>        intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"#990000"</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="随机森林" class="level3" data-number="1.2.3"><h3 data-number="1.2.3" class="anchored" data-anchor-id="随机森林">
<span class="header-section-number">1.2.3</span> 随机森林</h3>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">############################# #################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">rf_psm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>formula <span class="op">=</span>  <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">x.Age</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_psm</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  randomForest(formula = Smoke ~ x.Age + I(x.Age^2) + x.Gender,      data = data) </span></span>
<span><span class="co">#&gt;                Type of random forest: classification</span></span>
<span><span class="co">#&gt;                      Number of trees: 500</span></span>
<span><span class="co">#&gt; No. of variables tried at each split: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         OOB estimate of  error rate: 18.7%</span></span>
<span><span class="co">#&gt; Confusion matrix:</span></span>
<span><span class="co">#&gt;     0   1 class.error</span></span>
<span><span class="co">#&gt; 0 445 101   0.1849817</span></span>
<span><span class="co">#&gt; 1  86 368   0.1894273</span></span>
<span></span>
<span></span>
<span><span class="fu">tibble</span><span class="op">(</span>True <span class="op">=</span> <span class="va">tps_comp</span>,</span>
<span>       Estimate <span class="op">=</span> <span class="va">rf_psm</span><span class="op">$</span><span class="va">votes</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>       smoke <span class="op">=</span> <span class="va">smoke_comp</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">True</span>, <span class="va">Estimate</span>, colour <span class="op">=</span> <span class="va">smoke</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>        intercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        slope <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        color <span class="op">=</span> <span class="st">"#990000"</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="距离匹配算法-method" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="距离匹配算法-method">
<span class="header-section-number">1.3</span> 距离匹配算法 <code>method</code>
</h2>
<p><img src="images/clipboard-2321976132.png" class="img-fluid"></p>
<p>a caliper width of 0.2 of the standard deviation (SD) of the logit of PS be used</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#######  最近邻匹配 （NNM）      ##############</span></span>
<span></span>
<span><span class="va">logit_knn_ratio</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/matchit.html">matchit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">data</span>,</span>
<span>                 method <span class="op">=</span> <span class="st">"nearest"</span>, replace <span class="op">=</span> <span class="cn">T</span>, ratio <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">logit_knn_ratio</span><span class="op">$</span><span class="va">match.matrix</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;    [,1]  [,2]  [,3] </span></span>
<span><span class="co">#&gt; 1  "104" "295" "167"</span></span>
<span><span class="co">#&gt; 6  "105" "193" "283"</span></span>
<span><span class="co">#&gt; 10 "55"  "131" "281"</span></span>
<span><span class="co">#&gt; 15 "119" "134" "223"</span></span>
<span><span class="co">#&gt; 29 "82"  "180" "230"</span></span>
<span><span class="co">#&gt; 30 "55"  "131" "281"</span></span>
<span></span>
<span><span class="va">logit_knn_ratio</span><span class="op">$</span><span class="va">discarded</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># 记录是否有丢弃的患者</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">##########    最佳匹配 （OM）         #################</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">###########      遗传匹配 （GM） 是 PSM的扩展     ################</span></span>
<span><span class="co"># 进化搜索算法</span></span>
<span><span class="co"># 当除 PS 之外的其他协变量的所有权重都设置为 0 时，GM 将等效于 PSM。</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">#################  full matchin  #############3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>如果使用最佳匹配，则必须安装&nbsp;<em>optmatch</em>&nbsp;包，而基因匹配需要&nbsp;<em>rgenound</em>&nbsp;包。</p>
</section><section id="平衡诊断" class="level2" data-number="1.4"><h2 data-number="1.4" class="anchored" data-anchor-id="平衡诊断">
<span class="header-section-number">1.4</span> 平衡诊断</h2>
<section id="smd-和-vr" class="level3" data-number="1.4.1"><h3 data-number="1.4.1" class="anchored" data-anchor-id="smd-和-vr">
<span class="header-section-number">1.4.1</span> SMD 和 VR</h3>
<p><strong>比较治疗组和对照组中协变量的标准化均数差 （SMD） 和方差比 （VR）</strong></p>
<ol type="1">
<li><p>SMD 值为 &lt;0.1 ，至少&lt;0.25。</p></li>
<li><p>VR 是治疗组和对照组的方差比。接近 1.0 的 VR 表示协变量平衡，而 VR &lt;0.5 或 &gt;2.0 被认为“太极端”</p></li>
</ol>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m.out</span>, standardize <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; matchit(formula = Smoke ~ x.Age + x.Gender, data = data)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of Balance for All Data:</span></span>
<span><span class="co">#&gt;           Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span></span>
<span><span class="co">#&gt; distance         0.5199        0.3992          0.8545     0.6324    0.1981</span></span>
<span><span class="co">#&gt; x.Age           46.6476       43.0769          0.4638     0.1743    0.1277</span></span>
<span><span class="co">#&gt; x.Gender0        0.2269        0.5440         -0.7571          .    0.3171</span></span>
<span><span class="co">#&gt; x.Gender1        0.7731        0.4560          0.7571          .    0.3171</span></span>
<span><span class="co">#&gt;           eCDF Max</span></span>
<span><span class="co">#&gt; distance    0.5027</span></span>
<span><span class="co">#&gt; x.Age       0.4217</span></span>
<span><span class="co">#&gt; x.Gender0   0.3171</span></span>
<span><span class="co">#&gt; x.Gender1   0.3171</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Summary of Balance for Matched Data:</span></span>
<span><span class="co">#&gt;           Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span></span>
<span><span class="co">#&gt; distance         0.5199        0.4402          0.5646     0.7389    0.1388</span></span>
<span><span class="co">#&gt; x.Age           46.6476       46.3062          0.0443     0.1857    0.1108</span></span>
<span><span class="co">#&gt; x.Gender0        0.2269        0.4537         -0.5417          .    0.2269</span></span>
<span><span class="co">#&gt; x.Gender1        0.7731        0.5463          0.5417          .    0.2269</span></span>
<span><span class="co">#&gt;           eCDF Max Std. Pair Dist.</span></span>
<span><span class="co">#&gt; distance    0.4581          0.7250</span></span>
<span><span class="co">#&gt; x.Age       0.3282          2.2455</span></span>
<span><span class="co">#&gt; x.Gender0   0.2269          0.5417</span></span>
<span><span class="co">#&gt; x.Gender1   0.2269          0.5417</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample Sizes:</span></span>
<span><span class="co">#&gt;           Control Treated</span></span>
<span><span class="co">#&gt; All           546     454</span></span>
<span><span class="co">#&gt; Matched       454     454</span></span>
<span><span class="co">#&gt; Unmatched      92       0</span></span>
<span><span class="co">#&gt; Discarded       0       0</span></span>
<span><span class="co">#  summary 命令不加选择地计算离散变量和连续变量的 SMD，从而导致离散变量的偏差(被视为连续变量以检查摘要中的smd)</span></span>
<span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">after_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">match.data</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 由 CreateTableOne 函数汇总的匹配数据的基线协变量。</span></span>
<span><span class="va">tbl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tableone/man/CreateTableOne.html">CreateTableOne</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.Age"</span>,<span class="st">"x.Gender"</span>,<span class="st">"CVD"</span><span class="op">)</span>,</span>
<span>                       data <span class="op">=</span> <span class="va">after_match</span>,</span>
<span>                       factorVars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x.Gender"</span>,<span class="st">"CVD"</span><span class="op">)</span>,</span>
<span>                       strata <span class="op">=</span> <span class="st">"Smoke"</span>,smd <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># 此函数仅考虑匹配数据，并且均值差值由匹配数据 标准化（除以 SD）。匹配后，匹配数据中的标准差可能会更小，因此 SMD 可能比匹配前更大，尽管平均差值减小</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">tbl2</span>, showAllLevels <span class="op">=</span> <span class="cn">T</span>, smd <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Stratified by Smoke</span></span>
<span><span class="co">#&gt;                     level 0             1             p      test SMD   </span></span>
<span><span class="co">#&gt;   n                         454           454                           </span></span>
<span><span class="co">#&gt;   x.Age (mean (SD))       46.31 (17.87) 46.65 (7.70)   0.709       0.025</span></span>
<span><span class="co">#&gt;   x.Gender (%)      0       206 (45.4)    103 (22.7)  &lt;0.001       0.493</span></span>
<span><span class="co">#&gt;                     1       248 (54.6)    351 (77.3)                    </span></span>
<span><span class="co">#&gt;   CVD (%)           0       379 (83.5)    204 (44.9)  &lt;0.001       0.878</span></span>
<span><span class="co">#&gt;                     1        75 (16.5)    250 (55.1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>更好的方法是使用原始 SD，它由&nbsp;<em>cobalt</em>&nbsp;包中的&nbsp;<em>bal.tab</em>&nbsp;函数实现</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://ngreifer.github.io/cobalt/">cobalt</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"cobalt"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html">bal.tab</a></span><span class="op">(</span><span class="va">m.out</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">0.1</span>, v <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Balance Measures</span></span>
<span><span class="co">#&gt;              Type Diff.Adj        M.Threshold V.Ratio.Adj      V.Threshold</span></span>
<span><span class="co">#&gt; distance Distance   0.5646                         0.7389     Balanced, &lt;2</span></span>
<span><span class="co">#&gt; x.Age     Contin.   0.0443     Balanced, &lt;0.1      0.1857 Not Balanced, &gt;2</span></span>
<span><span class="co">#&gt; x.Gender   Binary   0.2269 Not Balanced, &gt;0.1           .                 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Balance tally for mean differences</span></span>
<span><span class="co">#&gt;                    count</span></span>
<span><span class="co">#&gt; Balanced, &lt;0.1         1</span></span>
<span><span class="co">#&gt; Not Balanced, &gt;0.1     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable with the greatest mean difference</span></span>
<span><span class="co">#&gt;  Variable Diff.Adj        M.Threshold</span></span>
<span><span class="co">#&gt;  x.Gender   0.2269 Not Balanced, &gt;0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Balance tally for variance ratios</span></span>
<span><span class="co">#&gt;                  count</span></span>
<span><span class="co">#&gt; Balanced, &lt;2         1</span></span>
<span><span class="co">#&gt; Not Balanced, &gt;2     1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variable with the greatest variance ratio</span></span>
<span><span class="co">#&gt;  Variable V.Ratio.Adj      V.Threshold</span></span>
<span><span class="co">#&gt;     x.Age      0.1857 Not Balanced, &gt;2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sample sizes</span></span>
<span><span class="co">#&gt;           Control Treated</span></span>
<span><span class="co">#&gt; All           546     454</span></span>
<span><span class="co">#&gt; Matched       454     454</span></span>
<span><span class="co">#&gt; Unmatched      92       0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="显著性检验" class="level3" data-number="1.4.2"><h3 data-number="1.4.2" class="anchored" data-anchor-id="显著性检验">
<span class="header-section-number">1.4.2</span> <strong>显著性检验</strong>
</h3>
<p>有人批评 P 值的增加可能是由于 PSM 后研究人群的样本量减少&nbsp;。应该使用解释匹配设计的统计数据，例如用于连续结果的配对 t 检验和 1：1 匹配设计中用于二分结果的 McNemar 检验 。这种做法很少在文献中实施或明确说明。</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">after_match</span><span class="op">)</span></span>
<span><span class="co">#&gt;   x.Age x.Gender Smoke CVD  distance weights subclass</span></span>
<span><span class="co">#&gt; 1    51        0     1   1 0.2763829       1        1</span></span>
<span><span class="co">#&gt; 2    50        0     0   0 0.2723902       1        3</span></span>
<span><span class="co">#&gt; 6    56        0     1   1 0.2968789       1      220</span></span>
<span><span class="co">#&gt; 7    59        0     0   0 0.3095888       1      247</span></span>
<span><span class="co">#&gt; 8    42        0     0   0 0.2417770       1       65</span></span>
<span><span class="co">#&gt; 9    78        0     0   1 0.3962738       1      355</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><em>Weights</em>&nbsp;列是为每个样本提供的权重。这些权重是通过精心设计的规则计算的，以确保匹配的治疗组和对照组的权重相似。可以看出，1 名参与者（编号 7）被多次匹配，导出的数据中的权重为 0.187 。在这种情况下，可以通过使用<em><code>weigts</code> 包中</em>带有&nbsp;<em><code><a href="https://rdrr.io/pkg/weights/man/wtd.t.test.html">wtd.t.test()</a></code></em>&nbsp;函数的加权 t 检验来执行带有权重的统计</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">weights</span>, quietly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"weights"</span><span class="op">)</span></span>
<span><span class="va">after_match</span> <span class="op">%&gt;%</span> <span class="fu">DT</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8e67499b613cf577da74" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8e67499b613cf577da74">{"x":{"filter":"none","vertical":false,"data":[["1","2","6","7","8","9","10","13","15","16","17","20","21","22","23","24","25","26","28","29","30","33","34","35","36","37","38","40","41","42","43","46","47","48","49","50","51","52","54","55","56","57","60","61","62","64","65","66","67","68","69","70","71","72","73","74","78","79","80","81","82","83","84","86","88","89","90","93","94","95","97","98","99","104","105","106","107","108","109","110","111","112","113","114","115","116","119","120","121","122","123","124","126","127","128","129","131","132","133","134","136","137","138","139","141","142","143","145","146","148","149","150","151","152","153","155","156","158","160","161","162","163","164","166","167","170","171","172","173","174","175","176","177","179","180","181","182","185","186","187","190","191","192","193","194","195","196","198","199","200","202","203","204","205","207","208","209","210","211","212","213","214","215","216","218","220","221","223","224","225","226","227","228","229","230","231","232","234","236","237","238","239","240","241","242","243","244","245","246","248","249","251","252","253","256","257","258","259","260","261","263","264","265","266","268","269","270","271","272","273","274","276","277","278","281","283","285","286","287","288","289","292","293","294","295","297","298","299","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","319","320","321","322","323","324","325","326","328","329","330","331","332","333","335","336","337","338","339","340","342","344","345","347","348","349","352","353","354","355","356","358","359","361","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","381","382","384","386","389","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000"],[51,50,56,59,42,78,47,63,43,72,71,46,78,61,50,44,58,48,59,45,47,61,78,51,45,41,51,52,59,37,40,49,45,45,55,52,42,51,52,47,47,42,54,74,49,93,59,51,59,42,46,48,57,78,37,51,37,46,49,54,45,78,48,78,61,73,53,52,64,42,50,55,37,51,56,37,40,37,49,49,40,67,60,37,49,33,43,78,40,51,78,37,48,56,78,78,47,36,44,43,44,71,37,85,45,44,78,52,41,48,46,37,40,37,45,51,45,46,55,54,37,37,45,64,50,58,64,49,37,37,37,37,37,61,45,41,58,81,42,59,58,63,27,56,58,37,54,37,51,55,37,39,37,37,62,61,44,37,53,41,78,34,52,37,37,37,53,43,37,33,51,62,52,37,45,53,52,70,57,52,55,51,70,46,45,78,69,47,41,67,37,45,36,68,37,64,47,51,57,37,42,53,43,37,44,60,40,37,27,36,37,79,37,48,47,56,61,39,51,60,58,36,64,42,50,37,78,37,59,42,63,68,67,80,78,58,47,37,46,45,48,51,44,38,42,37,53,47,37,41,57,55,46,51,59,71,40,57,38,37,73,46,37,39,37,34,47,56,48,43,47,43,53,39,40,43,37,70,51,43,55,44,84,43,51,37,60,39,48,51,45,52,78,37,73,43,37,54,63,55,52,45,41,45,59,72,45,45,37,33.5,50,61,41,41,41,48,11,34,42,41,41,40,50,42,43,61,35,25,41,59,17,46,50,51,41,27,41,41,37,53,36,57,30,60,50,42,47,32,40,35,46,33.5,68,54,41,36,29,67,37,36,59,40,50,50,41,46,33,50,45,65,50,50,64,41,63,53,21,41,40,43,33.5,41,37,50,33,43,16,68,41,31,55,42,42,42,55,66,44,33.5,43,31,68,38,51,22,45,41,41,45,79,63,45,63,47,68,41,39,5,21,60,16,67,46,54,35,41,43,46,45,44,47,53,38,43,32,25,23,51,57,50,69,63,56,53,40,19,44,39,41,41,36,33,50,43,78,33.5,39,43,59,41,55,41,41,26,54,38,70,60,42,48,24,33.5,36,47,50,68,41,54,82,33,41,54,51,59,25,33.5,82,52,26,22,35,74,41,41,53,29,51,53,33.5,40,14,40,63,50,48,45,38,22,59,65,49,78,50,25,50,60,37,50,42,45,52,50,29,33.5,32,58,52,68,43,52,69,32,47,50,28,50,46,18,50,50,41,33.5,20,61,41,40,13,28,49,27,53,62,33.5,37,51,40,64,82,57,45,22,33.5,33.5,72,42,55,30,39,21,40,34,33.5,50,11,50,21,52,34,49,48,44,25,52,26,43,73,61,34,35,67,18,44,42,43,25,41,47,60,50,42,32,27,26,56,54,24,50,44,20,41,47,47,39,38,56,40,36,60,59,28,79,35,29,47,69,50,63,54,56,78,39,70,37,49,50,31,37,41,55,69,40,44,37,33,31,67,24,41,41,68,37,50,51,67,42,41,50,44,31,81,52,33.5,29,32,51,33,33.5,39,71,57,57,63,62,65,34,55,34,2,18,57,43,63,57,59,35,41,50,28,46,37,33.5,40,52,11,33,50,50,56,48,39,50,33,50,73,39,26,48,54,69,51,50,45,57,56,48,27,33.5,51,23,33.5,66,39,40,23,45,26,84,54,49,64,47,47,13,66,20,40,41,39,50,41,69,48,59,35,51,33.5,35,47,54,30,56,34,41,50,76,33.5,47,41,44,58,59,44,33.5,31,40,43,56,50,33.5,54,58,52,50,34,41,51,38,69,53,41,31,40,34,33.5,49,34,41,22,43,54,51,42,57,48,40,65,33,27,50,69,77,31,45,60,20,59,50,50,32,33.5,55,55,56,26,67,46,33.5,40,33,30,41,57,73,20,40,26,33.5,49,33.5,34,65,50,41,37,66,41,50,50,30,33,41,49,48,37,64,32,42,48,22,33.5,35,34,24,41,51,86,33.5,41,35,55,50,57,8,41,41,61,23,43,54,27,50,58,31,46,43,52,41,51,43,41,50,58,39,41,33.5,35,23,42,50,19,33,32,64,25,36,63,20,24,34,82,36,41,33.5,51,43,70,39,57,31],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1"],["1","0","1","0","0","0","1","0","1","0","0","0","0","0","0","0","0","0","0","1","1","0","0","1","1","0","1","1","1","0","0","1","1","1","1","0","1","1","1","0","1","1","1","0","1","0","0","1","0","0","0","1","0","0","0","1","0","1","1","1","0","0","0","0","0","0","1","1","0","1","0","1","0","0","0","0","0","0","1","1","0","0","1","0","0","0","0","0","0","1","0","0","0","1","0","0","0","0","0","0","0","0","0","0","1","1","0","0","1","1","1","0","0","0","1","1","1","1","1","0","0","0","1","0","0","1","0","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","0","0","0","0","0","0","0","1","0","0","1","0","0","1","0","0","0","1","0","0","1","1","0","0","0","0","0","1","0","0","1","0","1","0","0","0","0","0","1","0","0","0","1","0","0","0","0","1","1","0","0","0","0","0","0","1","1","0","0","1","1","0","0","0","1","0","0","1","0","1","0","1","1","1","0","0","0","0","0","0","1","0","0","0","0","0","1","1","0","1","1","0","1","1","0","0","0","0","0","0","1","0","1","1","1","0","0","0","1","0","0","0","0","0","0","0","1","1","0","0","1","1","0","0","1","0","0","0","0","1","1","1","0","0","1","1","0","0","0","0","1","0","0","0","0","0","0","0","0","1","0","1","0","0","1","1","0","1","1","0","0","1","0","1","1","1","1","0","1","1","1","1","1","1","1","1","0","1","0","1","1","0","1","1","0","1","0","1","1","0","0","1","1","0","1","1","1","1","1","1","1","1","0","0","0","1","0","1","0","1","1","1","1","1","1","0","1","0","1","1","0","1","1","1","1","1","1","0","1","0","1","0","1","0","1","0","1","0","0","1","1","1","1","1","0","1","1","1","0","1","0","1","1","1","0","0","1","1","1","0","1","1","1","1","0","1","1","0","0","1","0","1","1","1","0","1","1","1","1","1","1","1","1","1","0","0","0","1","0","1","0","0","1","1","1","0","1","0","1","1","0","1","1","1","0","0","1","1","0","1","1","1","1","0","1","1","0","1","1","1","0","0","0","1","1","0","1","1","0","0","1","0","1","1","0","0","0","1","0","0","0","0","1","1","0","1","1","1","0","1","0","1","0","1","1","1","1","0","0","1","1","0","1","0","1","0","1","1","1","1","1","1","1","0","0","0","0","0","0","1","0","0","1","1","1","1","1","0","1","1","1","0","0","0","1","1","0","0","1","0","1","0","0","1","1","1","0","0","1","1","0","0","0","0","1","0","0","1","0","1","0","0","1","0","1","0","0","1","1","1","1","0","1","0","1","0","0","1","1","0","0","1","1","0","0","1","1","1","1","1","1","0","0","1","1","0","1","1","0","1","1","1","1","0","1","1","1","1","1","0","0","1","0","1","0","1","1","0","1","0","1","0","0","1","1","0","1","1","1","0","0","1","0","1","0","0","0","1","1","0","1","1","1","0","1","1","1","1","0","0","1","0","1","0","1","0","0","1","0","1","1","0","1","0","1","1","1","0","0","0","1","0","0","1","1","1","1","0","1","1","0","1","1","0","0","1","1","1","0","0","1","1","1","0","1","0","1","1","0","1","1","1","1","1","0","0","0","1","0","0","0","1","0","0","1","0","0","1","1","0","1","1","0","0","0","1","1","1","1","1","0","1","1","0","1","0","0","1","1","0","1","0","1","1","0","0","1","1","1","1","0","0","0","0","1","0","1","1","0","1","1","1","1","0","1","1","1","0","1","1","1","1","0","0","1","1","1","0","1","1","0","1","1","1","0","0","1","0","1","0","0","0","1","0","0","1","1","1","0","0","1","0","1","0","0","1","0","0","1","1","1","0","0","0","0","0","0","1","0","0","1","1","1","0","0","1","1","1","0","0","1","1","1","0","1","0","0","1","0","0","1","1","0","1","1","0","0","1","1","1","1","0","0","1","0","0","0","1","1","0","1","1","1","0","1","1","1","1","1","1","1","0","1","1","0","0","1","1","1","0","0","0","0","0","0","1","0","0","1","0","1","1","0","1","1","0","1","1","1"],["1","0","1","0","0","1","0","0","1","0","1","0","1","0","0","0","0","0","0","0","1","0","1","1","0","0","1","1","1","0","0","1","0","0","1","0","1","1","1","0","1","0","1","1","1","1","0","1","0","0","0","0","0","1","0","1","0","0","1","1","0","1","0","1","0","0","1","1","0","0","0","1","0","0","0","0","0","0","1","1","0","1","1","0","0","0","0","1","0","1","1","0","0","1","1","1","0","0","0","0","0","0","0","1","0","0","1","0","0","1","0","0","0","0","0","1","0","1","1","0","0","0","0","0","0","1","0","1","0","0","0","0","0","0","0","0","0","1","0","0","0","0","0","0","0","0","0","0","1","0","0","0","0","0","0","0","0","0","0","0","1","0","1","0","0","0","1","0","0","0","1","0","0","0","0","0","1","1","0","1","0","1","0","0","0","1","1","0","0","0","0","0","0","1","0","1","0","1","0","0","0","0","0","0","0","1","0","0","0","0","0","1","0","0","0","0","1","0","1","0","1","0","1","0","0","0","1","0","0","1","0","0","0","1","1","1","0","0","0","0","0","1","0","0","0","0","0","0","0","0","0","1","1","1","0","0","0","1","0","0","1","0","0","0","0","0","1","0","0","0","1","0","0","0","0","0","0","1","1","0","1","0","1","1","1","0","0","0","0","1","0","0","1","0","1","0","0","0","1","0","1","0","0","0","1","1","0","0","0","0","1","0","0","0","0","0","0","0","0","0","0","0","1","0","1","0","0","0","1","1","0","0","1","0","0","0","0","0","0","0","0","1","0","1","1","1","1","0","0","0","0","0","1","0","0","0","0","1","0","0","1","0","1","1","0","0","0","1","1","0","1","1","1","0","1","1","0","0","0","1","0","0","0","1","0","0","0","1","0","0","1","0","0","0","1","1","0","0","0","0","1","0","1","0","0","0","0","0","1","1","1","1","1","1","0","0","0","0","1","0","1","0","1","0","0","0","0","1","0","1","1","0","1","0","0","0","1","0","1","0","0","1","1","1","0","0","0","0","0","0","0","0","0","1","0","1","0","0","0","1","0","0","0","1","0","1","1","0","1","0","0","0","1","1","1","0","1","1","0","0","0","1","1","0","0","1","1","0","0","0","1","0","0","0","0","1","1","0","0","0","1","0","1","1","0","0","0","0","1","1","1","1","0","1","0","0","1","0","1","1","1","0","0","0","0","0","1","0","1","1","0","0","1","0","1","1","0","1","1","0","0","0","0","1","0","0","0","0","0","1","0","0","0","1","0","0","1","1","0","0","0","0","1","0","0","0","1","0","0","0","0","1","0","1","0","0","0","1","1","1","0","1","0","0","1","0","0","0","1","0","0","0","0","0","0","1","1","1","0","0","0","0","1","1","0","1","1","0","0","0","1","1","0","1","0","0","1","1","0","1","0","0","0","1","1","1","0","1","1","0","1","0","1","1","0","0","0","1","1","0","0","0","0","0","0","0","0","0","0","0","1","1","1","0","0","1","0","0","1","1","0","0","0","1","0","0","1","1","1","1","0","1","1","0","1","0","0","0","0","0","0","0","1","0","0","1","0","0","0","0","1","1","0","0","1","1","1","0","0","1","0","1","1","0","0","1","1","1","1","1","1","1","1","0","0","0","1","0","0","0","0","0","0","1","0","1","1","1","0","1","0","0","0","0","0","1","0","0","0","1","1","1","0","1","0","0","1","1","0","1","0","1","1","1","0","1","0","1","1","0","0","0","0","0","0","1","1","0","1","1","1","1","0","0","1","0","1","1","1","0","0","0","0","0","1","0","0","0","1","0","0","1","0","0","1","0","0","1","1","1","0","0","0","0","1","1","1","0","0","1","0","1","0","1","0","0","0","0","1","1","0","1","0","0","0","0","1","0","0","1","1","0","0","1","0","1","1","0","0","0","0","1","0","1","0","0","0","0","0","0","0","0","0","1","1","0","0","0","1","1","0","0","0","0","0","0","0","1","0","1","1","0","0","0","1","0","1","0","0","1","0","0","0","0","0","0","0","1","0","0","0","0","0","0","1","0","0","0","1","0","0","0","1","0","1","0","1","0"],[0.2763829196739098,0.2723902373374791,0.2968789199396898,0.3095887709934505,0.2417770115136718,0.3962738302279045,0.2606310340539383,0.3269909533486836,0.2454723529660944,0.3678759960838892,0.3632250375178519,0.2567851557030137,0.3962738302279045,0.3182264345130957,0.2723902373374791,0.2492056110548971,0.3053187914753052,0.2645140121544889,0.3095887709934505,0.2529766101450668,0.2606310340539383,0.3182264345130957,0.3962738302279045,0.2763829196739098,0.2529766101450668,0.2381197436912045,0.2763829196739098,0.2804115719325937,0.3095887709934505,0.2238739116456337,0.2345006881216863,0.268433837381485,0.2529766101450668,0.2529766101450668,0.2927099192267774,0.2804115719325937,0.2417770115136718,0.2763829196739098,0.2804115719325937,0.2606310340539383,0.2606310340539383,0.2417770115136718,0.2885754350189869,0.3772512967960946,0.268433837381485,0.4699850631476106,0.3095887709934505,0.2763829196739098,0.3095887709934505,0.2417770115136718,0.2567851557030137,0.2645140121544889,0.3010820224654068,0.3962738302279045,0.2238739116456337,0.2763829196739098,0.2238739116456337,0.2567851557030137,0.268433837381485,0.2885754350189869,0.2529766101450668,0.3962738302279045,0.2645140121544889,0.3962738302279045,0.3182264345130957,0.3725516658758689,0.2844758614062815,0.2804115719325937,0.3314194253436586,0.2417770115136718,0.2723902373374791,0.2927099192267774,0.2238739116456337,0.2763829196739098,0.2968789199396898,0.2238739116456337,0.2345006881216863,0.2238739116456337,0.268433837381485,0.268433837381485,0.2345006881216863,0.3448826871205342,0.3138914844090823,0.2238739116456337,0.268433837381485,0.2102451651817204,0.2454723529660944,0.3962738302279045,0.2345006881216863,0.2763829196739098,0.3962738302279045,0.2238739116456337,0.2645140121544889,0.2968789199396898,0.3962738302279045,0.3962738302279045,0.2606310340539383,0.2204087340879416,0.2492056110548971,0.2454723529660944,0.2492056110548971,0.3632250375178519,0.2238739116456337,0.4302976614206945,0.2529766101450668,0.2492056110548971,0.3962738302279045,0.2804115719325937,0.2381197436912045,0.2645140121544889,0.2567851557030137,0.2238739116456337,0.2345006881216863,0.2238739116456337,0.2529766101450668,0.2763829196739098,0.2529766101450668,0.2567851557030137,0.2927099192267774,0.2885754350189869,0.2238739116456337,0.2238739116456337,0.2529766101450668,0.3314194253436586,0.2723902373374791,0.3053187914753052,0.3314194253436586,0.268433837381485,0.2238739116456337,0.2238739116456337,0.2238739116456337,0.2238739116456337,0.2238739116456337,0.3182264345130957,0.2529766101450668,0.2381197436912045,0.3053187914753052,0.4107530769863906,0.2417770115136718,0.3095887709934505,0.3053187914753052,0.3269909533486836,0.1909618107755837,0.2968789199396898,0.3053187914753052,0.2238739116456337,0.2885754350189869,0.2238739116456337,0.2763829196739098,0.2927099192267774,0.2238739116456337,0.2309199653413115,0.2238739116456337,0.2238739116456337,0.322593103558986,0.3182264345130957,0.2492056110548971,0.2238739116456337,0.2844758614062815,0.2381197436912045,0.3962738302279045,0.2135943341781483,0.2804115719325937,0.2238739116456337,0.2238739116456337,0.2238739116456337,0.2844758614062815,0.2454723529660944,0.2238739116456337,0.2102451651817204,0.2763829196739098,0.322593103558986,0.2804115719325937,0.2238739116456337,0.2529766101450668,0.2844758614062815,0.2804115719325937,0.3585995224845395,0.3010820224654068,0.2804115719325937,0.2927099192267774,0.2763829196739098,0.3585995224845395,0.2567851557030137,0.2529766101450668,0.3962738302279045,0.3540001651260865,0.2606310340539383,0.2381197436912045,0.3448826871205342,0.2238739116456337,0.2529766101450668,0.2204087340879416,0.3494276610724914,0.2238739116456337,0.3314194253436586,0.2606310340539383,0.2763829196739098,0.3010820224654068,0.2238739116456337,0.2417770115136718,0.2844758614062815,0.2454723529660944,0.2238739116456337,0.2492056110548971,0.3138914844090823,0.2345006881216863,0.2238739116456337,0.1909618107755837,0.2204087340879416,0.2238739116456337,0.4010814220563076,0.2238739116456337,0.2645140121544889,0.2606310340539383,0.2968789199396898,0.3182264345130957,0.2309199653413115,0.2763829196739098,0.3138914844090823,0.3053187914753052,0.2204087340879416,0.3314194253436586,0.2417770115136718,0.2723902373374791,0.2238739116456337,0.3962738302279045,0.2238739116456337,0.3095887709934505,0.2417770115136718,0.3269909533486836,0.3494276610724914,0.3448826871205342,0.4059081249848162,0.3962738302279045,0.3053187914753052,0.2606310340539383,0.2238739116456337,0.2567851557030137,0.2529766101450668,0.2645140121544889,0.2763829196739098,0.2492056110548971,0.2273776780953943,0.2417770115136718,0.2238739116456337,0.2844758614062815,0.2606310340539383,0.2238739116456337,0.2381197436912045,0.3010820224654068,0.2927099192267774,0.2567851557030137,0.2763829196739098,0.3095887709934505,0.3632250375178519,0.2345006881216863,0.3010820224654068,0.2273776780953943,0.2238739116456337,0.3725516658758689,0.2567851557030137,0.2238739116456337,0.2309199653413115,0.2238739116456337,0.2135943341781483,0.2606310340539383,0.2968789199396898,0.2645140121544889,0.2454723529660944,0.2606310340539383,0.2454723529660944,0.2844758614062815,0.2309199653413115,0.2345006881216863,0.2454723529660944,0.2238739116456337,0.3585995224845395,0.2763829196739098,0.2454723529660944,0.2927099192267774,0.2492056110548971,0.4253886022985618,0.2454723529660944,0.2763829196739098,0.2238739116456337,0.3138914844090823,0.2309199653413115,0.2645140121544889,0.2763829196739098,0.2529766101450668,0.2804115719325937,0.3962738302279045,0.2238739116456337,0.3725516658758689,0.2454723529660944,0.2238739116456337,0.2885754350189869,0.3269909533486836,0.2927099192267774,0.2804115719325937,0.2529766101450668,0.2381197436912045,0.2529766101450668,0.3095887709934505,0.3678759960838892,0.2529766101450668,0.2529766101450668,0.2238739116456337,0.5325972531197832,0.6133619684730971,0.6641985454014508,0.5697863976846134,0.5697863976846134,0.5697863976846134,0.6038082045681539,0.4205192280248629,0.5350925203905447,0.5746952137398196,0.5697863976846134,0.5697863976846134,0.5648638230488892,0.6133619684730971,0.5746952137398196,0.5795893460314782,0.6641985454014508,0.540077665351761,0.4900299848253295,0.5697863976846134,0.6551947850146944,0.4500873237183482,0.5941745635888492,0.6133619684730971,0.6181068257230147,0.5697863976846134,0.5000556963292515,0.5697863976846134,0.5697863976846134,0.5500229564471031,0.6275284878391437,0.5450548036933609,0.646078248634938,0.5150916606152178,0.6597110836018824,0.6133619684730971,0.5746952137398196,0.5990009469364378,0.5251021575928807,0.5648638230488892,0.540077665351761,0.5941745635888492,0.5325972531197832,0.6947539342815527,0.6322037413422467,0.5697863976846134,0.5450548036933609,0.5100813630468893,0.6904845186900218,0.5500229564471031,0.5450548036933609,0.6551947850146944,0.5648638230488892,0.6133619684730971,0.6133619684730971,0.5697863976846134,0.5941745635888492,0.5301003541544926,0.6133619684730971,0.5893299163097957,0.6818479577031449,0.6133619684730971,0.6133619684730971,0.677481826561112,0.5697863976846134,0.6730845053012354,0.6275284878391437,0.4700106362902688,0.5697863976846134,0.5648638230488892,0.5795893460314782,0.5325972531197832,0.5697863976846134,0.5500229564471031,0.6133619684730971,0.5301003541544926,0.5795893460314782,0.4451288966429993,0.6947539342815527,0.5697863976846134,0.5200989264779527,0.6368542709469432,0.5746952137398196,0.5746952137398196,0.5746952137398196,0.6368542709469432,0.6861823608781087,0.584467880789429,0.5325972531197832,0.5795893460314782,0.5200989264779527,0.6947539342815527,0.5549811517825803,0.6181068257230147,0.4750089555448027,0.5893299163097957,0.5697863976846134,0.5697863976846134,0.5893299163097957,0.7394350398327231,0.6730845053012354,0.5893299163097957,0.6730845053012354,0.5990009469364378,0.6947539342815527,0.5697863976846134,0.5599284257565212,0.3915106540119719,0.4700106362902688,0.6597110836018824,0.4451288966429993,0.6904845186900218,0.5941745635888492,0.6322037413422467,0.540077665351761,0.5697863976846134,0.5795893460314782,0.5941745635888492,0.5893299163097957,0.584467880789429,0.5990009469364378,0.6275284878391437,0.5549811517825803,0.5795893460314782,0.5251021575928807,0.4900299848253295,0.4800122871793797,0.6181068257230147,0.646078248634938,0.6133619684730971,0.6989901313945425,0.6730845053012354,0.641479344653986,0.6275284878391437,0.5648638230488892,0.4600330135976763,0.584467880789429,0.5599284257565212,0.5697863976846134,0.5697863976846134,0.5450548036933609,0.5301003541544926,0.6133619684730971,0.5795893460314782,0.735552694041266,0.5325972531197832,0.5599284257565212,0.5795893460314782,0.6551947850146944,0.5697863976846134,0.6368542709469432,0.5697863976846134,0.5697863976846134,0.495042342209866,0.6322037413422467,0.5549811517825803,0.7031926544060717,0.6597110836018824,0.5746952137398196,0.6038082045681539,0.4850196313079013,0.5325972531197832,0.5450548036933609,0.5990009469364378,0.6133619684730971,0.6947539342815527,0.5697863976846134,0.6322037413422467,0.7508585423398884,0.5301003541544926,0.5697863976846134,0.6322037413422467,0.6181068257230147,0.6551947850146944,0.4900299848253295,0.5325972531197832,0.7508585423398884,0.6228292602344062,0.495042342209866,0.4750089555448027,0.540077665351761,0.7196576152359295,0.5697863976846134,0.5697863976846134,0.6275284878391437,0.5100813630468893,0.6181068257230147,0.6275284878391437,0.5325972531197832,0.5648638230488892,0.4352456981173188,0.5648638230488892,0.6730845053012354,0.6133619684730971,0.6038082045681539,0.5893299163097957,0.5549811517825803,0.4750089555448027,0.6551947850146944,0.6818479577031449,0.6085954891754649,0.735552694041266,0.6133619684730971,0.4900299848253295,0.6133619684730971,0.6597110836018824,0.5500229564471031,0.6133619684730971,0.5746952137398196,0.5893299163097957,0.6228292602344062,0.6133619684730971,0.5100813630468893,0.5325972531197832,0.5251021575928807,0.6506502875792108,0.6228292602344062,0.6947539342815527,0.5795893460314782,0.6228292602344062,0.6989901313945425,0.5251021575928807,0.5990009469364378,0.6133619684730971,0.5050690392498146,0.6133619684730971,0.5941745635888492,0.455055686702302,0.6133619684730971,0.6133619684730971,0.5697863976846134,0.5325972531197832,0.4650183252862413,0.6641985454014508,0.5697863976846134,0.5648638230488892,0.4303228283769461,0.5050690392498146,0.6085954891754649,0.5000556963292515,0.6275284878391437,0.6686565521153148,0.5325972531197832,0.5500229564471031,0.6181068257230147,0.5648638230488892,0.677481826561112,0.7508585423398884,0.646078248634938,0.5893299163097957,0.4750089555448027,0.5325972531197832,0.5325972531197832,0.7114949588582642,0.5746952137398196,0.6368542709469432,0.5150916606152178,0.5599284257565212,0.4700106362902688,0.5648638230488892,0.5350925203905447,0.5325972531197832,0.6133619684730971,0.4205192280248629,0.6133619684730971,0.4700106362902688,0.6228292602344062,0.5350925203905447,0.6085954891754649,0.6038082045681539,0.584467880789429,0.4900299848253295,0.6228292602344062,0.495042342209866,0.5795893460314782,0.7155939322211372,0.6641985454014508,0.5350925203905447,0.540077665351761,0.6904845186900218,0.455055686702302,0.584467880789429,0.5746952137398196,0.5795893460314782,0.4900299848253295,0.5697863976846134,0.5990009469364378,0.6597110836018824,0.6133619684730971,0.5746952137398196,0.5251021575928807,0.5000556963292515,0.495042342209866,0.641479344653986,0.6322037413422467,0.4850196313079013,0.6133619684730971,0.584467880789429,0.4650183252862413,0.5697863976846134,0.5990009469364378,0.5990009469364378,0.5599284257565212,0.5549811517825803,0.641479344653986,0.5648638230488892,0.5450548036933609,0.6597110836018824,0.6551947850146944,0.5050690392498146,0.7394350398327231,0.540077665351761,0.5100813630468893,0.5990009469364378,0.6989901313945425,0.6133619684730971,0.6730845053012354,0.6322037413422467,0.641479344653986,0.735552694041266,0.5599284257565212,0.7031926544060717,0.5500229564471031,0.6085954891754649,0.6133619684730971,0.5200989264779527,0.5500229564471031,0.5697863976846134,0.6368542709469432,0.6989901313945425,0.5648638230488892,0.584467880789429,0.5500229564471031,0.5301003541544926,0.5200989264779527,0.6904845186900218,0.4850196313079013,0.5697863976846134,0.5697863976846134,0.6947539342815527,0.5500229564471031,0.6133619684730971,0.6181068257230147,0.6904845186900218,0.5746952137398196,0.5697863976846134,0.6133619684730971,0.584467880789429,0.5200989264779527,0.7470881870099781,0.6228292602344062,0.5325972531197832,0.5100813630468893,0.5251021575928807,0.6181068257230147,0.5301003541544926,0.5325972531197832,0.5599284257565212,0.7073610683405402,0.646078248634938,0.646078248634938,0.6730845053012354,0.6686565521153148,0.6818479577031449,0.5350925203905447,0.6368542709469432,0.5350925203905447,0.3772754158153639,0.455055686702302,0.646078248634938,0.5795893460314782,0.6730845053012354,0.646078248634938,0.6551947850146944,0.540077665351761,0.5697863976846134,0.6133619684730971,0.5050690392498146,0.5941745635888492,0.5500229564471031,0.5325972531197832,0.5648638230488892,0.6228292602344062,0.4205192280248629,0.5301003541544926,0.6133619684730971,0.6133619684730971,0.641479344653986,0.6038082045681539,0.5599284257565212,0.6133619684730971,0.5301003541544926,0.6133619684730971,0.7155939322211372,0.5599284257565212,0.495042342209866,0.6038082045681539,0.6322037413422467,0.6989901313945425,0.6181068257230147,0.6133619684730971,0.5893299163097957,0.646078248634938,0.641479344653986,0.6038082045681539,0.5000556963292515,0.5325972531197832,0.6181068257230147,0.4800122871793797,0.5325972531197832,0.6861823608781087,0.5599284257565212,0.5648638230488892,0.4800122871793797,0.5893299163097957,0.495042342209866,0.7582858451975969,0.6322037413422467,0.6085954891754649,0.677481826561112,0.5990009469364378,0.5990009469364378,0.4303228283769461,0.6861823608781087,0.4650183252862413,0.5648638230488892,0.5697863976846134,0.5599284257565212,0.6133619684730971,0.5697863976846134,0.6989901313945425,0.6038082045681539,0.6551947850146944,0.540077665351761,0.6181068257230147,0.5325972531197832,0.540077665351761,0.5990009469364378,0.6322037413422467,0.5150916606152178,0.641479344653986,0.5350925203905447,0.5697863976846134,0.6133619684730971,0.7276777196809158,0.5325972531197832,0.5990009469364378,0.5697863976846134,0.584467880789429,0.6506502875792108,0.6551947850146944,0.584467880789429,0.5325972531197832,0.5200989264779527,0.5648638230488892,0.5795893460314782,0.641479344653986,0.6133619684730971,0.5325972531197832,0.6322037413422467,0.6506502875792108,0.6228292602344062,0.6133619684730971,0.5350925203905447,0.5697863976846134,0.6181068257230147,0.5549811517825803,0.6989901313945425,0.6275284878391437,0.5697863976846134,0.5200989264779527,0.5648638230488892,0.5350925203905447,0.5325972531197832,0.6085954891754649,0.5350925203905447,0.5697863976846134,0.4750089555448027,0.5795893460314782,0.6322037413422467,0.6181068257230147,0.5746952137398196,0.646078248634938,0.6038082045681539,0.5648638230488892,0.6818479577031449,0.5301003541544926,0.5000556963292515,0.6133619684730971,0.6989901313945425,0.7316334966380681,0.5200989264779527,0.5893299163097957,0.6597110836018824,0.4650183252862413,0.6551947850146944,0.6133619684730971,0.6133619684730971,0.5251021575928807,0.5325972531197832,0.6368542709469432,0.6368542709469432,0.641479344653986,0.495042342209866,0.6904845186900218,0.5941745635888492,0.5325972531197832,0.5648638230488892,0.5301003541544926,0.5150916606152178,0.5697863976846134,0.646078248634938,0.7155939322211372,0.4650183252862413,0.5648638230488892,0.495042342209866,0.5325972531197832,0.6085954891754649,0.5325972531197832,0.5350925203905447,0.6818479577031449,0.6133619684730971,0.5697863976846134,0.5500229564471031,0.6861823608781087,0.5697863976846134,0.6133619684730971,0.6133619684730971,0.5150916606152178,0.5301003541544926,0.5697863976846134,0.6085954891754649,0.6038082045681539,0.5500229564471031,0.677481826561112,0.5251021575928807,0.5746952137398196,0.6038082045681539,0.4750089555448027,0.5325972531197832,0.540077665351761,0.5350925203905447,0.4850196313079013,0.5697863976846134,0.6181068257230147,0.7655608618056127,0.5325972531197832,0.5697863976846134,0.540077665351761,0.6368542709469432,0.6133619684730971,0.646078248634938,0.4059328818784684,0.5697863976846134,0.5697863976846134,0.6641985454014508,0.4800122871793797,0.5795893460314782,0.6322037413422467,0.5000556963292515,0.6133619684730971,0.6506502875792108,0.5200989264779527,0.5941745635888492,0.5795893460314782,0.6228292602344062,0.5697863976846134,0.6181068257230147,0.5795893460314782,0.5697863976846134,0.6133619684730971,0.6506502875792108,0.5599284257565212,0.5697863976846134,0.5325972531197832,0.540077665351761,0.4800122871793797,0.5746952137398196,0.6133619684730971,0.4600330135976763,0.5301003541544926,0.5251021575928807,0.677481826561112,0.4900299848253295,0.5450548036933609,0.6730845053012354,0.4650183252862413,0.4850196313079013,0.5350925203905447,0.7508585423398884,0.5450548036933609,0.5697863976846134,0.5325972531197832,0.6181068257230147,0.5795893460314782,0.7031926544060717,0.5599284257565212,0.646078248634938,0.5200989264779527],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],["1","3","220","247","65","355","2","253","14","439","92","21","324","441","433","70","104","443","226","45","48","356","308","65","67","302","74","81","88","66","54","124","133","138","147","403","161","170","183","6","198","204","221","410","233","187","116","254","380","1","78","278","96","303","56","302","25","333","340","347","147","301","237","297","348","428","399","413","384","424","383","445","11","110","323","49","43","424","4","5","36","284","6","204","404","28","413","279","32","7","268","161","312","8","243","242","42","46","57","183","19","450","71","85","9","10","210","393","11","12","13","69","29","63","15","16","17","18","19","318","14","55","20","371","140","21","354","22","37","24","10","80","79","337","8","254","327","132","76","219","304","188","39","288","296","77","264","53","23","87","34","73","20","17","293","314","24","15","185","25","209","61","26","9","138","133","27","81","67","28","29","282","335","45","220","448","30","180","449","31","425","32","119","88","60","205","214","33","170","255","58","34","40","244","52","328","35","36","285","18","31","420","27","13","37","38","23","333","39","40","64","182","62","41","75","265","42","72","43","150","44","46","47","30","273","51","202","35","195","49","160","215","249","152","193","50","51","33","52","53","232","54","55","233","26","198","386","47","48","56","117","57","58","59","174","442","16","60","124","2","423","38","41","68","12","61","62","112","211","63","64","399","320","66","7","347","278","111","68","69","70","445","90","71","72","22","453","59","115","73","50","300","192","5","421","221","4","258","75","419","76","44","74","77","78","436","79","80","340","357","82","196","83","84","85","86","103","87","89","90","91","92","93","94","95","270","96","229","97","98","142","99","100","345","101","352","102","103","248","274","104","105","418","106","107","108","109","110","111","112","113","342","430","454","114","346","115","163","116","117","118","119","120","121","389","122","408","123","125","222","126","127","128","129","130","131","175","132","381","134","336","135","212","136","398","137","267","149","139","140","141","142","143","339","144","145","146","334","148","338","149","150","151","134","144","152","153","154","184","155","156","157","158","262","159","160","365","167","162","252","163","164","165","451","166","167","168","169","171","172","173","174","175","406","218","266","176","105","177","411","130","178","179","180","452","181","230","182","184","341","185","186","187","153","331","188","189","98","190","191","192","193","326","194","195","143","196","197","199","146","330","313","200","201","311","202","203","368","397","205","391","206","207","169","325","378","208","239","95","437","114","209","210","178","211","212","213","309","214","390","215","155","216","217","218","219","369","118","222","223","159","224","156","225","106","226","227","228","229","230","231","232","305","385","322","292","329","203","234","412","351","235","236","237","238","239","108","240","241","242","295","434","286","243","244","84","200","245","289","246","317","290","247","248","249","128","382","250","251","310","276","271","307","252","316","416","253","148","255","120","257","256","102","257","137","283","258","259","260","261","154","262","168","263","444","360","264","265","400","94","266","267","194","125","268","269","270","271","272","273","281","164","274","275","395","276","277","429","279","280","281","282","234","283","284","285","286","287","172","190","288","109","289","427","290","291","344","292","166","293","197","206","294","295","260","296","297","298","431","246","299","176","300","217","426","349","301","303","376","304","305","306","350","307","308","309","310","199","358","311","256","312","294","313","394","241","314","272","315","316","157","317","401","318","319","320","409","89","250","321","291","432","322","323","324","325","158","326","327","240","328","329","101","377","330","331","332","372","208","334","335","336","91","337","122","338","339","440","341","342","343","344","345","364","280","238","346","261","236","145","348","213","181","349","113","405","350","351","417","352","353","83","191","388","354","355","356","357","358","446","359","360","422","361","231","379","362","363","392","364","107","365","366","129","227","367","368","369","370","207","319","225","86","371","165","372","373","224","374","375","376","377","100","378","379","380","353","381","382","383","384","93","216","385","386","387","299","388","389","332","390","391","392","179","407","393","269","394","362","135","415","395","162","321","396","397","398","259","201","400","315","401","99","363","402","186","173","403","404","405","375","97","263","131","367","177","406","136","82","407","408","409","151","298","410","411","412","359","373","414","415","416","435","417","245","275","418","277","127","419","420","343","421","422","414","126","423","425","426","427","370","139","428","374","396","171","429","430","235","431","432","433","141","434","435","436","437","438","439","440","287","441","442","123","361","443","444","446","438","366","223","447","402","306","447","189","251","448","387","449","450","121","451","452","228","453","454","3"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>x.Age<\/th>\n      <th>x.Gender<\/th>\n      <th>Smoke<\/th>\n      <th>CVD<\/th>\n      <th>distance<\/th>\n      <th>weights<\/th>\n      <th>subclass<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"x.Age","targets":1},{"name":"x.Gender","targets":2},{"name":"Smoke","targets":3},{"name":"CVD","targets":4},{"name":"distance","targets":5},{"name":"weights","targets":6},{"name":"subclass","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html">attach</a></span><span class="op">(</span><span class="va">after_match</span><span class="op">)</span></span>
<span><span class="va">age_trt</span> <span class="op">&lt;-</span> <span class="va">after_match</span><span class="op">[</span><span class="va">Smoke</span><span class="op">==</span> <span class="fl">1</span>, <span class="st">"x.Age"</span><span class="op">]</span></span>
<span><span class="va">weight_trt</span> <span class="op">&lt;-</span> <span class="va">after_match</span><span class="op">[</span><span class="va">Smoke</span><span class="op">==</span> <span class="fl">1</span>, <span class="st">"weights"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">age_ctrl</span> <span class="op">&lt;-</span> <span class="va">after_match</span><span class="op">[</span><span class="va">Smoke</span><span class="op">==</span> <span class="fl">0</span>, <span class="st">"x.Age"</span><span class="op">]</span></span>
<span><span class="va">weight_ctrl</span> <span class="op">&lt;-</span> <span class="va">after_match</span><span class="op">[</span><span class="va">Smoke</span><span class="op">==</span> <span class="fl">0</span>, <span class="st">"weights"</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/weights/man/wtd.t.test.html">wtd.t.test</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">age_ctrl</span>, y <span class="op">=</span> <span class="va">age_trt</span>,</span>
<span>        weight <span class="op">=</span> <span class="va">weight_ctrl</span>, weighty <span class="op">=</span> <span class="va">weight_trt</span><span class="op">)</span></span>
<span><span class="co">#&gt; $test</span></span>
<span><span class="co">#&gt; [1] "Two Sample Weighted T-Test (Welch)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $coefficients</span></span>
<span><span class="co">#&gt;     t.value          df     p.value </span></span>
<span><span class="co">#&gt;  -0.1176369 848.0506954   0.9063832 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $additional</span></span>
<span><span class="co">#&gt; Difference     Mean.x     Mean.y   Std. Err </span></span>
<span><span class="co">#&gt; -0.1085573 46.4285714 46.5371287  0.9228169</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/detach.html">detach</a></span><span class="op">(</span><span class="va">after_match</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>t 检验，则应对协变量值的顺序进行排序</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">match_trt</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">$</span><span class="va">match.matrix</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">matx</span> <span class="op">&lt;-</span> <span class="va">m.out</span><span class="op">$</span><span class="va">match.matrix</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matx</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matx</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">matx</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">match_ctrl</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">matx</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">match_ctrl</span><span class="op">$</span><span class="va">x.Age</span>, <span class="va">match_trt</span><span class="op">$</span><span class="va">x.Age</span>, paired <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Welch Two Sample t-test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  match_ctrl$x.Age and match_trt$x.Age</span></span>
<span><span class="co">#&gt; t = -0.3739, df = 615.61, p-value = 0.7086</span></span>
<span><span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  -2.134594  1.451775</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; mean of x mean of y </span></span>
<span><span class="co">#&gt;  46.30617  46.64758</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Kolmogorov-Smirnov （KS） 统计</p>
<p><em>cobalt</em> 包中的函数 <em>bal.tab</em> 还提供 KS 检验，该检验比较处理组和对照组之间协变量的分布。唯一的要求是设置 <em>ks.threshold</em> 参数。</p>
</section><section id="分布可视化" class="level3" data-number="1.4.3"><h3 data-number="1.4.3" class="anchored" data-anchor-id="分布可视化">
<span class="header-section-number">1.4.3</span> <strong>分布可视化</strong>
</h3>
<p>直方图、分位数-分位数图、累积分布函数 ，love plots</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m.out</span>, type<span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<pre><code>#&gt; To identify the units, use first mouse button; to stop, use second.
plot(m.out, type= "hist")</code></pre>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>,var.name <span class="op">=</span> <span class="st">"x.Age"</span>, which <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>         grid <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>,var.name <span class="op">=</span> <span class="st">"x.Gender"</span>, which <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>         grid <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.plot.html">bal.plot</a></span><span class="op">(</span><span class="va">m.out</span>,var.name <span class="op">=</span> <span class="st">"x.Age"</span>, which <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>         grid <span class="op">=</span> <span class="cn">T</span>, type <span class="op">=</span> <span class="st">"ecdf"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/love.plot.html">love.plot</a></span><span class="op">(</span><span class="fu"><a href="https://ngreifer.github.io/cobalt/reference/bal.tab.html">bal.tab</a></span><span class="op">(</span><span class="va">m.out</span>, thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">0.1</span>, v <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          grid <span class="op">=</span> <span class="cn">T</span>, stars <span class="op">=</span> <span class="st">"raw"</span>, </span>
<span>          abs <span class="op">=</span> <span class="cn">F</span>,stats <span class="op">=</span> <span class="st">"mean.diffs"</span></span>
<span>          <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="拟合优度指标" class="level3" data-number="1.4.4"><h3 data-number="1.4.4" class="anchored" data-anchor-id="拟合优度指标">
<span class="header-section-number">1.4.4</span> <strong>拟合优度指标</strong>
</h3>
<p>c-statistics, or area under the receiver operating characteristic curve (AUROC)</p>
<p>。但是，这些统计数据没有提供关于是否正确指定 PS 型号的信息</p>
</section><section id="如果协变量在匹配后仍然不平衡该怎么办" class="level3" data-number="1.4.5"><h3 data-number="1.4.5" class="anchored" data-anchor-id="如果协变量在匹配后仍然不平衡该怎么办">
<span class="header-section-number">1.4.5</span> 如果协变量在匹配后仍然不平衡，该怎么办？</h3>
<ol type="1">
<li><p>更改公式 <code>formula</code>，甚至模型 <code>distance</code> ， 机器学习</p></li>
<li><p>更改匹配方法 <code>method</code>，更改更小的卡尺 <code>caliper = 0.1</code>，<em><code>pop.size</code></em><code>=100</code> 的 GM&nbsp;</p></li>
<li><p>将 PSM 与精确匹配方法相结合 <code>exact=c（'x.Gender'）</code> ， 不推荐</p></li>
<li><p>增加样本量</p></li>
<li><p>PSM 后基线协变量的残差可以通过匹配、分层、回归调整等常规方法处理</p></li>
</ol></section></section><section id="非随机试验中的二分类治疗效果" class="level2" data-number="1.5"><h2 data-number="1.5" class="anchored" data-anchor-id="非随机试验中的二分类治疗效果">
<span class="header-section-number">1.5</span> 非随机试验中的二分类治疗效果</h2>
<p>在 Rubin 提出的反事实框架下，对于每个个体，在治疗分配之前有两种潜在结果（在治疗或控制条件下）。一旦患者接受治疗或对照，研究人员就会观察到两种结果中的一种，但另一种结果缺失。在某种程度上，观察性研究中的数据分析就像缺失结果的插值。</p>
<p>Abadie 和 Imbens 提出了一个适合匹配的治疗效果估计量。在匹配数据中，所有协变量在处理组和对照组之间具有相似的分布。这意味着匹配的患者被认为是相似的。使用匹配的对照组的平均结果对治疗组的缺失结果进行插值，反之亦然。假设接受治疗的患者具有平均结果 （A）。在估计 PS 并进行匹配后，我们将对照条件下接受治疗的患者的结局与匹配患者的结局进行插值。如果他们没有接受治疗，他们对结果的期望应该是 B。因此，我们在匹配数据上比较两个平均结果 （A vs.&nbsp;B），以估计对接受治疗的平均治疗效果。</p>
<p>the average treatment effect (ATE) and the average treatment effect on the treated (ATT).</p>
<section id="att" class="level3" data-number="1.5.1"><h3 data-number="1.5.1" class="anchored" data-anchor-id="att">
<span class="header-section-number">1.5.1</span> ATT</h3>
<p><em>Zelig</em>&nbsp;包估计 Monte Carlo 模拟的因果效应,但<em>Zelig</em>&nbsp;包不再维护更新</p>
<p><strong>Translating Zelig to clarify</strong></p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/iqss/clarify">"clarify"</a></span><span class="op">)</span></span>
<span><span class="va">after_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://kosukeimai.github.io/MatchIt/reference/match.data.html">match.data</a></span><span class="op">(</span><span class="va">m.out</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">CVD</span> <span class="op">~</span> <span class="va">Smoke</span> <span class="op">+</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>, data <span class="op">=</span> <span class="va">after_match</span>,</span>
<span>           family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,weights <span class="op">=</span> <span class="va">after_match</span><span class="op">$</span><span class="va">weights</span> <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_coefs</span> <span class="op">&lt;-</span> <span class="fu">clarify</span><span class="fu">::</span><span class="fu"><a href="https://iqss.github.io/clarify/reference/sim.html">sim</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">sim_coefs</span></span>
<span><span class="co">#&gt; A `clarify_sim` object</span></span>
<span><span class="co">#&gt;  - 4 coefficients, 1000 simulated values</span></span>
<span><span class="co">#&gt;  - sampled distribution: multivariate normal</span></span>
<span><span class="co">#&gt;  - original fitting function call:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; glm(formula = CVD ~ Smoke + x.Age + x.Gender, family = binomial(link = "logit"), </span></span>
<span><span class="co">#&gt;     data = after_match, weights = after_match$weights)</span></span>
<span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://iqss.github.io/clarify/reference/sim_ame.html">sim_ame</a></span><span class="op">(</span><span class="va">sim_coefs</span>, var <span class="op">=</span> <span class="st">"Smoke"</span>, subset <span class="op">=</span> <span class="va">Smoke</span> <span class="op">==</span> <span class="fl">1</span>,</span>
<span>               contrast <span class="op">=</span> <span class="st">"rr"</span> , verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>   <span class="co"># "diff" ,sr, ar</span></span>
<span></span>
<span><span class="va">est</span></span>
<span><span class="co">#&gt; A `clarify_est` object (from `sim_ame()`)</span></span>
<span><span class="co">#&gt;  - Average adjusted predictions for `Smoke`</span></span>
<span><span class="co">#&gt;  - 1000 simulated values</span></span>
<span><span class="co">#&gt;  - 3 quantities estimated:                    </span></span>
<span><span class="co">#&gt;  E[Y(0)]  0.01111425</span></span>
<span><span class="co">#&gt;  E[Y(1)]  0.55066079</span></span>
<span><span class="co">#&gt;  RR      49.54547289</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate    2.5 %   97.5 %</span></span>
<span><span class="co">#&gt; E[Y(0)]  0.01111  0.00722  0.01750</span></span>
<span><span class="co">#&gt; E[Y(1)]  0.55066  0.52059  0.57988</span></span>
<span><span class="co">#&gt; RR      49.54547 31.86784 76.39909</span></span>
<span></span>
<span><span class="co"># 绘制 ATT</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="PSM_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ATT_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">Smoke</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">d</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, newdata <span class="op">=</span> <span class="va">d</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`E[Y(0)]` <span class="op">=</span> <span class="va">p0</span>, `E[Y(1)]` <span class="op">=</span> <span class="va">p1</span>, `RR` <span class="op">=</span> <span class="va">p1</span> <span class="op">/</span> <span class="va">p0</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://iqss.github.io/clarify/reference/sim_apply.html">sim_apply</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim_coefs</span>, <span class="va">ATT_func</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">sim_est</span></span>
<span><span class="co">#&gt; A `clarify_est` object (from `sim_apply()`)</span></span>
<span><span class="co">#&gt;  - 1000 simulated values</span></span>
<span><span class="co">#&gt;  - 3 quantities estimated:                  </span></span>
<span><span class="co">#&gt;  E[Y(0)] 0.5506608</span></span>
<span><span class="co">#&gt;  E[Y(1)] 0.5506608</span></span>
<span><span class="co">#&gt;  RR      1.0000000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sim_est</span><span class="op">)</span></span>
<span><span class="co">#&gt;         Estimate 2.5 % 97.5 %</span></span>
<span><span class="co">#&gt; E[Y(0)]    0.551 0.521  0.580</span></span>
<span><span class="co">#&gt; E[Y(1)]    0.551 0.521  0.580</span></span>
<span><span class="co">#&gt; RR         1.000 1.000  1.000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="敏感性分析" class="level3" data-number="1.5.2"><h3 data-number="1.5.2" class="anchored" data-anchor-id="敏感性分析">
<span class="header-section-number">1.5.2</span> 敏感性分析</h3>
<section id="rosenbaum-的原始敏感性分析" class="level4" data-number="1.5.2.1"><h4 data-number="1.5.2.1" class="anchored" data-anchor-id="rosenbaum-的原始敏感性分析">
<span class="header-section-number">1.5.2.1</span> Rosenbaum 的原始敏感性分析</h4>
<p>常用函数&nbsp;<em>binarysens</em>&nbsp;和&nbsp;<em>psens</em>。前者用于二元结果，后者用于连续或顺序结果。</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">rbounds</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="e-值" class="level4" data-number="1.5.2.2"><h4 data-number="1.5.2.2" class="anchored" data-anchor-id="e-值">
<span class="header-section-number">1.5.2.2</span> E 值</h4>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">EValue</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"EValue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/EValue/man/evalue.html">evalue</a></span><span class="op">(</span>est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/EValue/man/effect_measures.html">RR</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span>, lo <span class="op">=</span> <span class="fl">.7</span>, hi <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span>
<span><span class="co">#&gt;             point lower    upper</span></span>
<span><span class="co">#&gt; RR       0.800000   0.7 0.900000</span></span>
<span><span class="co">#&gt; E-values 1.809017    NA 1.462475</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="倾向得分校准-psc" class="level4" data-number="1.5.2.3"><h4 data-number="1.5.2.3" class="anchored" data-anchor-id="倾向得分校准-psc">
<span class="header-section-number">1.5.2.3</span> 倾向得分校准 （PSC）</h4>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mdl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span>,family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">PS_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mdl1</span>, newdata <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,<span class="op">]</span>,type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mdl2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span>,family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">PS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mdl2</span>, newdata <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span>,type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mdl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Smoke</span> <span class="op">~</span> <span class="va">x.Age</span> <span class="op">+</span> <span class="va">x.Gender</span>,family <span class="op">=</span> <span class="va">binomial</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="va">PS3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mdl3</span>, newdata <span class="op">=</span> <span class="va">data</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span>,type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">PS2</span>,<span class="va">PS3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mdl_calibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">PS3</span> <span class="op">~</span> <span class="va">PS2</span>,data <span class="op">=</span> <span class="va">data_reg</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps_calibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mdl_calibrated</span>, x <span class="op">=</span> <span class="va">PS_raw</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section></section><section id="多分类或连续治疗" class="level2" data-number="1.6"><h2 data-number="1.6" class="anchored" data-anchor-id="多分类或连续治疗">
<span class="header-section-number">1.6</span> 多分类或连续治疗</h2>
</section><section id="时间依赖性协变量" class="level2" data-number="1.7"><h2 data-number="1.7" class="anchored" data-anchor-id="时间依赖性协变量">
<span class="header-section-number">1.7</span> 时间依赖性协变量</h2>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./PropensityScore.html" class="pagination-link" aria-label="倾向性评分">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">倾向性评分</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./matching.html" class="pagination-link" aria-label="匹配（Matching）">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">匹配（Matching）</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>